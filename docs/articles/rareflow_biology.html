<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Cell-fate transitions as rare events • rareflow</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Cell-fate transitions as rare events">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rareflow</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/PietroPiu-labstats/rareflow" aria-label="GitHub repository"><span class="fa fab fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Cell-fate transitions as rare events</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/PietroPiu-labstats/rareflow/blob/HEAD/vignettes/rareflow_biology.Rmd" class="external-link"><code>vignettes/rareflow_biology.Rmd</code></a></small>
      <div class="d-none name"><code>rareflow_biology.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="simple-eulermaruyama-sde-simulator">Simple Euler–Maruyama SDE simulator<a class="anchor" aria-label="anchor" href="#simple-eulermaruyama-sde-simulator"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simulate_sde</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">f</span>, <span class="va">x0</span>, <span class="va">dt</span>, <span class="va">n</span>, <span class="va">sigma</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x0</span><span class="op">)</span></span>
<span>  <span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span>, <span class="va">d</span><span class="op">)</span></span>
<span>  <span class="va">X</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">x0</span></span>
<span>  </span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">drift</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">X</span><span class="op">[</span><span class="va">i</span> <span class="op">-</span> <span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">noise</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">d</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">dt</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">X</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">[</span><span class="va">i</span> <span class="op">-</span> <span class="fl">1</span>, <span class="op">]</span> <span class="op">+</span> <span class="va">drift</span> <span class="op">*</span> <span class="va">dt</span> <span class="op">+</span> <span class="va">sigma</span> <span class="op">*</span> <span class="va">noise</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">X</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Cell-fate decisions in developmental biology often emerge from the
interplay between nonlinear gene regulatory networks and intrinsic
biological noise. Cells may reside in metastable progenitor states
before committing to one of several differentiated phenotypes. These
transitions are rare events, driven by fluctuations that push the system
across energetic barriers separating stable attractors. In this
vignette, we show how rareflow can be used to: - reconstruct a
Freidlin–Wentzell quasipotential for a bistable gene regulatory network
- identify stable phenotypes and metastable progenitor states - compute
the minimum action path (MAP) representing the most probable
differentiation trajectory - quantify the barrier height separating cell
fates This provides a computational analogue of the classical Waddington
epigenetic landscape.</p>
</div>
<div class="section level2">
<h2 id="a-bistable-gene-regulatory-network">A bistable gene regulatory network<a class="anchor" aria-label="anchor" href="#a-bistable-gene-regulatory-network"></a>
</h2>
<p>We consider a minimal 2-gene system with mutual inhibition:</p>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>d</mi><msub><mi>x</mi><mn>1</mn></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>−</mo><msubsup><mi>x</mi><mn>1</mn><mn>3</mn></msubsup><mo>−</mo><mi>α</mi><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mi>d</mi><mi>t</mi><mo>+</mo><mi>σ</mi><mspace width="0.167em"></mspace><mi>d</mi><msub><mi>W</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>d</mi><msub><mi>x</mi><mn>2</mn></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo>−</mo><msubsup><mi>x</mi><mn>2</mn><mn>3</mn></msubsup><mo>−</mo><mi>α</mi><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mi>d</mi><mi>t</mi><mo>+</mo><mi>σ</mi><mspace width="0.167em"></mspace><mi>d</mi><msub><mi>W</mi><mn>2</mn></msub></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}dx_1&amp;=(x_1-x_1^3-\alpha x_2)\, dt+\sigma \, dW_1\\ dx_2&amp;=(x_2-x_2^3-\alpha x_1)\, dt+\sigma \, dW_2\end{aligned}</annotation></semantics></math><p>This system exhibits: - two stable attractors (phenotypes A and B) -
one metastable state near the origin (progenitor M) - rare noise-induced
transitions between states</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.6</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">^</span><span class="fl">3</span> <span class="op">-</span> <span class="va">alpha</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>    <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">^</span><span class="fl">3</span> <span class="op">-</span> <span class="va">alpha</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="simulating-stochastic-trajectories">Simulating stochastic trajectories<a class="anchor" aria-label="anchor" href="#simulating-stochastic-trajectories"></a>
</h2>
<p>We simulate a trajectory starting near the progenitor state.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu">simulate_sde</span><span class="op">(</span></span>
<span>  f <span class="op">=</span> <span class="va">f</span>,</span>
<span>  x0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>  dt <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>  sigma <span class="op">=</span> <span class="fl">0.2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">X</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x1"</span>, <span class="st">"x2"</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#ggplot(df, aes(x1, x2, color = time)) +</span></span>
<span><span class="co">#  geom_path(alpha = 0.7) +</span></span>
<span><span class="co">#  scale_color_viridis_c() +</span></span>
<span><span class="co">#  theme_minimal() +</span></span>
<span><span class="co">#  labs(title = "Stochastic trajectory in gene expression space")</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="fitting-a-freidlinwentzell-model-with-rareflow">Fitting a Freidlin–Wentzell model with rareflow<a class="anchor" aria-label="anchor" href="#fitting-a-freidlinwentzell-model-with-rareflow"></a>
</h2>
<div class="section level3">
<h3 id="freidlinwentzell-quasipotential">Freidlin–Wentzell quasipotential<a class="anchor" aria-label="anchor" href="#freidlinwentzell-quasipotential"></a>
</h3>
<p>We directly compute the Freidlin–Wentzell quasipotential between a
progenitor state M and a differentiated state A.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>       <span class="co"># progenitor state M</span></span>
<span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">0.5</span><span class="op">)</span>    <span class="co"># phenotype A</span></span>
<span></span>
<span><span class="va">qp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/FW_quasipotential.html">FW_quasipotential</a></span><span class="op">(</span></span>
<span>  x0 <span class="op">=</span> <span class="va">x0</span>,</span>
<span>  x1 <span class="op">=</span> <span class="va">x1</span>,</span>
<span>  drift <span class="op">=</span> <span class="va">f</span>,</span>
<span>  T <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  dt <span class="op">=</span> <span class="fl">0.01</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="schematic-epigenetic-landscape-2d-contour">Schematic epigenetic landscape (2D contour)<a class="anchor" aria-label="anchor" href="#schematic-epigenetic-landscape-2d-contour"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span>, length.out <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="va">y_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span>, length.out <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span></span>
<span><span class="va">landscape_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x_seq</span>, y <span class="op">=</span> <span class="va">y_seq</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Evaluate quasipotential on grid</span></span>
<span><span class="va">V_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">landscape_grid</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/FW_quasipotential.html">FW_quasipotential</a></span><span class="op">(</span></span>
<span>    x0 <span class="op">=</span> <span class="va">x0</span>,</span>
<span>    x1 <span class="op">=</span> <span class="va">z</span>,</span>
<span>    drift <span class="op">=</span> <span class="va">f</span>,</span>
<span>    T <span class="op">=</span> <span class="fl">200</span>,</span>
<span>    dt <span class="op">=</span> <span class="fl">0.01</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">action</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">landscape_grid</span><span class="op">$</span><span class="va">V</span> <span class="op">&lt;-</span> <span class="va">V_vals</span></span>
<span></span>
<span><span class="co">#ggplot(landscape_grid, aes(x, y, z = V)) +</span></span>
<span><span class="co">#  geom_contour_filled(bins = 20) +</span></span>
<span><span class="co">#  scale_fill_viridis_d() +</span></span>
<span><span class="co">#  theme_minimal() +</span></span>
<span><span class="co">#  labs(title = "Schematic epigenetic landscape (FW quasipotential)")</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="minimum-action-path-the-most-probable-differentiation-trajectory">Minimum action path: the most probable differentiation
trajectory<a class="anchor" aria-label="anchor" href="#minimum-action-path-the-most-probable-differentiation-trajectory"></a>
</h2>
<p>We compute the MAP from the progenitor state M to phenotype A.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">path_MA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/FW_minimum_action_path.html">FW_minimum_action_path</a></span><span class="op">(</span></span>
<span>  x0 <span class="op">=</span> <span class="va">x0</span>,</span>
<span>  x1 <span class="op">=</span> <span class="va">x1</span>,</span>
<span>  drift <span class="op">=</span> <span class="va">f</span>,</span>
<span>  T <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  dt <span class="op">=</span> <span class="fl">0.01</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract the path matrix (robust to different internal structures)</span></span>
<span><span class="va">path_matrix</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">is.matrix</a></span><span class="op">(</span><span class="va">path_MA</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">path_matrix</span> <span class="op">&lt;-</span> <span class="va">path_MA</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="st">"path"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">path_MA</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">path_matrix</span> <span class="op">&lt;-</span> <span class="va">path_MA</span><span class="op">$</span><span class="va">path</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="st">"X"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">path_MA</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">path_matrix</span> <span class="op">&lt;-</span> <span class="va">path_MA</span><span class="op">$</span><span class="va">X</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Cannot find trajectory matrix in FW_minimum_action_path() output."</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">path_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">path_matrix</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">path_df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x1"</span>, <span class="st">"x2"</span><span class="op">)</span></span>
<span><span class="va">path_df</span><span class="op">$</span><span class="va">step</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">path_df</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#ggplot(path_df, aes(x1, x2)) +</span></span>
<span><span class="co">#  theme_minimal() +</span></span>
<span><span class="co"># lab(title = "Minimum action path (MAP)")</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="overlay-map-on-the-fw-landscape">Overlay MAP on the FW landscape<a class="anchor" aria-label="anchor" href="#overlay-map-on-the-fw-landscape"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">path_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">path_matrix</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">path_df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x1"</span>, <span class="st">"x2"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#ggplot(landscape_grid, aes(x, y, z = V)) +</span></span>
<span><span class="co">#  geom_contour_filled(bins = 20, alpha = 0.8) +</span></span>
<span><span class="co">#  scale_fill_viridis_d() +</span></span>
<span><span class="co">#  geom_path(data = path_df, aes(x1, x2),</span></span>
<span><span class="co">#            color = "red", size = 1.2, inherit.aes = FALSE</span></span>
<span><span class="co">#) +</span></span>
<span><span class="co">#  theme_minimal() +</span></span>
<span><span class="co">#  labs(title = "Minimum action path over the epigenetic landscape")</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sjmgarnier.github.io/viridis/" class="external-link">viridis</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">grid</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ---- Directional Arrows on MAP ----</span></span>
<span><span class="va">path_df_arrows</span> <span class="op">&lt;-</span> <span class="va">path_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>x1_next <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">lead</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span>, x2_next <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">lead</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">x1_next</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ---- Nature-style Theme ----</span></span>
<span><span class="va">theme_nature</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>,</span>
<span>    plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span>b <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span>,</span>
<span>    axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># ---- Panel A: Stochastic Trajectory----</span></span>
<span><span class="va">pA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, color <span class="op">=</span> <span class="va">time</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span>, size <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_c</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">theme_nature</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"A. Stochastic trajectory"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Noise-driven excursions around the progenitor state"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Time"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># ---- Panel B: FW Landscape----</span></span>
<span><span class="va">pB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">landscape_grid</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, z <span class="op">=</span> <span class="va">V</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_contour.html" class="external-link">geom_contour_filled</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_d</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"mako"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">theme_nature</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>    legend.key.width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>    legend.key.height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>    legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>,</span>
<span>    plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span>t <span class="op">=</span> <span class="fl">20</span>, r <span class="op">=</span> <span class="fl">10</span>, b <span class="op">=</span> <span class="fl">15</span>, l <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"B. Epigenetic landscape (FW quasipotential)"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Dark basins = stable phenotypes; shallow region = progenitor state"</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"V(x)"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># ---- Panel C: MAP ----</span></span>
<span><span class="va">pC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">path_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">path_df_arrows</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x1</span>, y <span class="op">=</span> <span class="va">x2</span>, xend <span class="op">=</span> <span class="va">x1_next</span>, yend <span class="op">=</span> <span class="va">x2_next</span><span class="op">)</span>,</span>
<span>    arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html" class="external-link">arrow</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"closed"</span>, length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"red"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">theme_nature</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"C. Minimum action path (MAP)"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Most probable transition trajectory under weak noise"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># ---- Panel D: MAP + Landscape ----</span></span>
<span><span class="va">pD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">landscape_grid</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, z <span class="op">=</span> <span class="va">V</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_contour.html" class="external-link">geom_contour_filled</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">20</span>, alpha <span class="op">=</span> <span class="fl">0.85</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_d</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"mako"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">path_df</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x1</span>, y <span class="op">=</span> <span class="va">x2</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">1.2</span>,</span>
<span>    inherit.aes <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">path_df_arrows</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x1</span>, y <span class="op">=</span> <span class="va">x2</span>, xend <span class="op">=</span> <span class="va">x1_next</span>, yend <span class="op">=</span> <span class="va">x2_next</span><span class="op">)</span>,</span>
<span>    arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html" class="external-link">arrow</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"closed"</span>, length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>    inherit.aes <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">theme_nature</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>    legend.key.width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>    legend.key.height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>    legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>,</span>
<span>    plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span>t <span class="op">=</span> <span class="fl">20</span>, r <span class="op">=</span> <span class="fl">10</span>, b <span class="op">=</span> <span class="fl">15</span>, l <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"D. MAP over the FW landscape"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"The MAP crosses the saddle region: the most probable transition point"</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"V(x)"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># ---- Final 2×2 composition----</span></span>
<span><span class="op">(</span><span class="va">pA</span> <span class="op">|</span> <span class="va">pB</span><span class="op">)</span> <span class="op">/</span></span>
<span><span class="op">(</span><span class="va">pC</span> <span class="op">|</span> <span class="va">pD</span><span class="op">)</span></span></code></pre></div>
<p><img src="rareflow_biology_files/figure-html/fig-nature-1.png" class="r-plt" alt="" width="960"></p>
</div>
<div class="section level2">
<h2 id="biological-interpretation">Biological interpretation<a class="anchor" aria-label="anchor" href="#biological-interpretation"></a>
</h2>
<p>This example illustrates how rareflow can be used to: • reconstruct a
data-driven epigenetic landscape • identify stable phenotypes as minima
of the quasipotential • quantify barrier heights between cell fates •
compute most probable differentiation trajectories • study how noise
shapes developmental decisions</p>
<p>Such analyses are relevant for: • single-cell transcriptomics •
developmental biology • cell reprogramming • gene regulatory network
inference</p>
</div>
<div class="section level2">
<h2 id="biological-insights">Biological insights<a class="anchor" aria-label="anchor" href="#biological-insights"></a>
</h2>
<p>The bistable system explored in this vignette captures a recurring
motif in developmental biology: <strong>cell-fate decisions emerging
from noisy regulatory dynamics</strong>. Although the model is minimal,
its qualitative structure mirrors the behaviour of real gene regulatory
networks involved in differentiation, reprogramming, and lineage
commitment.</p>
<div class="section level3">
<h3 id="the-quasipotential-as-an-epigenetic-landscape">The quasipotential as an epigenetic landscape<a class="anchor" aria-label="anchor" href="#the-quasipotential-as-an-epigenetic-landscape"></a>
</h3>
<p>The Freidlin–Wentzell quasipotential computed above provides a
quantitative analogue of <strong>Waddington’s epigenetic
landscape</strong>. In this representation:</p>
<ul>
<li>
<strong>deep minima</strong> correspond to stable phenotypes (A and
B),</li>
<li>the <strong>shallow basin</strong> near the origin represents a
metastable progenitor state (M),</li>
<li>the <strong>saddle region</strong> between basins encodes the
energetic difficulty of switching fate.</li>
</ul>
<p>Unlike heuristic drawings of Waddington’s landscape, the FW
quasipotential is derived directly from the underlying dynamics and
noise structure. It therefore captures how intrinsic fluctuations shape
the accessibility of different phenotypic states.</p>
</div>
<div class="section level3">
<h3 id="noise-driven-transitions-and-developmental-variability">Noise-driven transitions and developmental variability<a class="anchor" aria-label="anchor" href="#noise-driven-transitions-and-developmental-variability"></a>
</h3>
<p>In biological systems, noise is not merely a nuisance: it can
actively drive rare transitions that enable cells to explore alternative
fates.<br>
The minimum action path (MAP) computed by rareflow represents the
<strong>most probable trajectory</strong> a cell follows when committing
to a new phenotype under weak noise.</p>
<p>This trajectory is not arbitrary. It reflects:</p>
<ul>
<li>the geometry of the regulatory network,</li>
<li>the relative stability of competing attractors,</li>
<li>the direction in which fluctuations are most effective at pushing
the system.</li>
</ul>
<p>In developmental contexts, such MAPs correspond to <strong>canalized
differentiation routes</strong>, where cells follow reproducible paths
despite stochasticity.</p>
</div>
<div class="section level3">
<h3 id="barrier-heights-and-phenotypic-stability">Barrier heights and phenotypic stability<a class="anchor" aria-label="anchor" href="#barrier-heights-and-phenotypic-stability"></a>
</h3>
<p>The height of the FW barrier separating M from A or B provides a
natural measure of <strong>phenotypic stability</strong>. A higher
barrier implies:</p>
<ul>
<li>stronger resistance to noise-induced switching,</li>
<li>longer residence times in a given state,</li>
<li>greater robustness of the phenotype.</li>
</ul>
<p>This concept is central in understanding:</p>
<ul>
<li>why some cell types are stable over long timescales,</li>
<li>why progenitor states are more plastic,</li>
<li>how perturbations (mutations, signalling cues) reshape developmental
trajectories.</li>
</ul>
</div>
<div class="section level3">
<h3 id="broader-implications">Broader implications<a class="anchor" aria-label="anchor" href="#broader-implications"></a>
</h3>
<p>Although this vignette uses a simple 2-gene model, the same
principles apply to high-dimensional single-cell transcriptomic data,
where rareflow can help:</p>
<ul>
<li>infer effective landscapes from observed trajectories,</li>
<li>quantify transition probabilities between cell states,</li>
<li>identify lineage bifurcations,</li>
<li>compare wild-type and perturbed conditions.</li>
</ul>
<p>In this sense, rareflow provides a computational bridge between
<strong>stochastic dynamical systems theory</strong> and <strong>modern
single-cell biology</strong>, enabling data-driven reconstructions of
the landscapes that govern cellular identity.</p>
</div>
</div>
<div class="section level2">
<h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a>
</h2>
<div class="section level3">
<h3 id="stochastic-gene-regulatory-model">Stochastic gene regulatory model<a class="anchor" aria-label="anchor" href="#stochastic-gene-regulatory-model"></a>
</h3>
<p>We model a minimal two-gene regulatory circuit with mutual
inhibition, a common motif in developmental systems. The dynamics of
gene expression levels
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">x = (x_1, x_2)</annotation></semantics></math>
follow a stochastic differential equation (SDE):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>x</mi><mo>=</mo><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mi>d</mi><mi>t</mi><mo>+</mo><mi>σ</mi><mspace width="0.167em"></mspace><mi>d</mi><msub><mi>W</mi><mi>t</mi></msub><mo>,</mo></mrow><annotation encoding="application/x-tex">
dx = f(x)\,dt + \sigma\,dW_t,
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>W</mi><mi>t</mi></msub><annotation encoding="application/x-tex">W_t</annotation></semantics></math>
is a two-dimensional Wiener process and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>
controls the noise amplitude. The drift term encodes self-activation and
cross-repression:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>x</mi><mn>1</mn></msub><mo>−</mo><msubsup><mi>x</mi><mn>1</mn><mn>3</mn></msubsup><mo>−</mo><mi>α</mi><msub><mi>x</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>x</mi><mn>2</mn></msub><mo>−</mo><msubsup><mi>x</mi><mn>2</mn><mn>3</mn></msubsup><mo>−</mo><mi>α</mi><msub><mi>x</mi><mn>1</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
f(x_1, x_2) =
\begin{pmatrix}
x_1 - x_1^3 - \alpha x_2 \\
x_2 - x_2^3 - \alpha x_1
\end{pmatrix},
</annotation></semantics></math></p>
<p>with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>0.6</mn></mrow><annotation encoding="application/x-tex">\alpha = 0.6</annotation></semantics></math>.
This system exhibits two stable attractors corresponding to
differentiated phenotypes and a metastable state near the origin
representing a progenitor cell.</p>
</div>
<div class="section level3">
<h3 id="numerical-simulation-of-stochastic-trajectories">Numerical simulation of stochastic trajectories<a class="anchor" aria-label="anchor" href="#numerical-simulation-of-stochastic-trajectories"></a>
</h3>
<p>Stochastic trajectories were generated using the Euler–Maruyama
scheme with time step
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>t</mi><mo>=</mo><mn>0.01</mn></mrow><annotation encoding="application/x-tex">dt = 0.01</annotation></semantics></math>
and noise amplitude
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>=</mo><mn>0.2</mn></mrow><annotation encoding="application/x-tex">\sigma = 0.2</annotation></semantics></math>.
The simulator implements:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mi>t</mi><mo>+</mo><mi>d</mi><mi>t</mi></mrow></msub><mo>=</mo><msub><mi>x</mi><mi>t</mi></msub><mo>+</mo><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mi>d</mi><mi>t</mi><mo>+</mo><mi>σ</mi><msqrt><mrow><mi>d</mi><mi>t</mi></mrow></msqrt><mspace width="0.167em"></mspace><msub><mi>ξ</mi><mi>t</mi></msub><mo>,</mo></mrow><annotation encoding="application/x-tex">
x_{t+dt} = x_t + f(x_t)\,dt + \sigma \sqrt{dt}\,\xi_t,
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ξ</mi><mi>t</mi></msub><mo>∼</mo><mi>𝒩</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msub><mi>I</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\xi_t \sim \mathcal{N}(0, I_2)</annotation></semantics></math>.
Trajectories of length 5000 steps were used to illustrate noise-induced
excursions around the metastable region.</p>
</div>
<div class="section level3">
<h3 id="freidlinwentzell-quasipotential-1">Freidlin–Wentzell quasipotential<a class="anchor" aria-label="anchor" href="#freidlinwentzell-quasipotential-1"></a>
</h3>
<p>To quantify the stability landscape underlying the dynamics, we
compute the Freidlin–Wentzell (FW) quasipotential
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">V(x)</annotation></semantics></math>,
defined as the minimal action required for the system to transition from
an initial state
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mn>0</mn></msub><annotation encoding="application/x-tex">x_0</annotation></semantics></math>
to a target state
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
under vanishing noise:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munder><mo>inf</mo><mrow><mi>ϕ</mi><mo>:</mo><mi>ϕ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>x</mi><mn>0</mn></msub><mo>,</mo><mspace width="0.167em"></mspace><mi>ϕ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>T</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>x</mi></mrow></munder><mfrac><mn>1</mn><mn>2</mn></mfrac><msubsup><mo>∫</mo><mn>0</mn><mi>T</mi></msubsup><mo stretchy="false" form="postfix">∥</mo><mover><mi>ϕ</mi><mo accent="true">̇</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ϕ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><msup><mo stretchy="false" form="postfix">∥</mo><mn>2</mn></msup><mi>d</mi><mi>t</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">
V(x) = \inf_{\phi: \phi(0)=x_0,\, \phi(T)=x}
\frac{1}{2} \int_0^T \|\dot{\phi}(t) - f(\phi(t))\|^2 dt.
</annotation></semantics></math></p>
<p>The quasipotential was computed using the
<code><a href="../reference/FW_quasipotential.html">FW_quasipotential()</a></code> function in rareflow, with integration
horizon
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>=</mo><mn>200</mn></mrow><annotation encoding="application/x-tex">T = 200</annotation></semantics></math>
and time step
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>t</mi><mo>=</mo><mn>0.01</mn></mrow><annotation encoding="application/x-tex">dt = 0.01</annotation></semantics></math>.
This yields a scalar field whose minima correspond to stable phenotypes
and whose saddle regions quantify transition barriers.</p>
</div>
<div class="section level3">
<h3 id="minimum-action-path-map">Minimum action path (MAP)<a class="anchor" aria-label="anchor" href="#minimum-action-path-map"></a>
</h3>
<p>The most probable transition trajectory between two states under weak
noise is given by the minimum action path (MAP), defined as the curve
<span class="math inline">$\phi^\*$</span> that minimizes the FW action
functional. The MAP satisfies the Euler–Lagrange equations associated
with the FW functional and represents the dominant transition pathway in
the low-noise limit.</p>
<p>We compute the MAP using <code><a href="../reference/FW_minimum_action_path.html">FW_minimum_action_path()</a></code> with
the same integration parameters as above. The resulting trajectory is
interpolated and visualized over the quasipotential landscape to
illustrate the canalized route of differentiation.</p>
</div>
<div class="section level3">
<h3 id="landscape-visualization">Landscape visualization<a class="anchor" aria-label="anchor" href="#landscape-visualization"></a>
</h3>
<p>The FW quasipotential was evaluated on a two-dimensional grid
spanning
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mrow><mo stretchy="true" form="prefix">[</mo><mi>−</mi><mn>2</mn><mo>,</mo><mn>2</mn><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><annotation encoding="application/x-tex">[-2, 2]^2</annotation></semantics></math>.
Contour plots were generated using <code>ggplot2</code> to produce a
schematic epigenetic landscape. The MAP was overlaid on the contour map
to highlight the relationship between landscape geometry and transition
dynamics.</p>
<p>All computations were performed using the rareflow package (version
X.X.X) in R.</p>
</div>
<div class="section level3">
<h3 id="model-parameters">Model parameters<a class="anchor" aria-label="anchor" href="#model-parameters"></a>
</h3>
<table class="table">
<colgroup>
<col width="33%">
<col width="43%">
<col width="23%">
</colgroup>
<thead><tr class="header">
<th>Parameter</th>
<th>Description</th>
<th>Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></td>
<td>Strength of mutual inhibition between genes</td>
<td>0.6</td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></td>
<td>Noise amplitude in the SDE</td>
<td>0.2</td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">dt</annotation></semantics></math></td>
<td>Time step for Euler–Maruyama integration</td>
<td>0.01</td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math></td>
<td>Number of simulation steps</td>
<td>5000</td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mn>0</mn></msub><annotation encoding="application/x-tex">x_0</annotation></semantics></math></td>
<td>Initial (progenitor) state</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(0, 0)</annotation></semantics></math></td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mn>1</mn></msub><annotation encoding="application/x-tex">x_1</annotation></semantics></math></td>
<td>Target (phenotype A) state</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mi>−</mi><mn>0.5</mn><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(1, -0.5)</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math></td>
<td>Integration horizon for FW computations</td>
<td>200</td>
</tr>
<tr class="even">
<td>Drift
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">f(x)</annotation></semantics></math>
</td>
<td>Regulatory dynamics</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>−</mo><msubsup><mi>x</mi><mn>1</mn><mn>3</mn></msubsup><mo>−</mo><mi>α</mi><msub><mi>x</mi><mn>2</mn></msub><mo>,</mo><mspace width="0.278em"></mspace><msub><mi>x</mi><mn>2</mn></msub><mo>−</mo><msubsup><mi>x</mi><mn>2</mn><mn>3</mn></msubsup><mo>−</mo><mi>α</mi><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_1 - x_1^3 - \alpha x_2,\; x_2 - x_2^3 - \alpha x_1)</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td>Noise model</td>
<td>Stochastic forcing</td>
<td>Gaussian, i.i.d.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝒩</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msub><mi>I</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal{N}(0, I_2)</annotation></semantics></math>
</td>
</tr>
<tr class="even">
<td>MAP solver</td>
<td>Minimum action path algorithm</td>
<td><code><a href="../reference/FW_minimum_action_path.html">FW_minimum_action_path()</a></code></td>
</tr>
<tr class="odd">
<td>Landscape solver</td>
<td>Freidlin–Wentzell quasipotential</td>
<td><code><a href="../reference/FW_quasipotential.html">FW_quasipotential()</a></code></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="limitations-and-assumptions">Limitations and assumptions<a class="anchor" aria-label="anchor" href="#limitations-and-assumptions"></a>
</h2>
<p>The model and analyses presented in this vignette are intentionally
minimal and serve primarily as a conceptual demonstration of how
rareflow can be applied to biological systems. Several simplifying
assumptions should be noted.</p>
<p><strong>Low-dimensional dynamics.</strong><br>
The two-gene regulatory network used here captures the qualitative
structure of bistability but does not reflect the high dimensionality of
real transcriptional regulatory systems. In practice, cell-fate
decisions involve dozens to hundreds of interacting genes, and the
effective landscape may be substantially more complex.</p>
<p><strong>Additive, isotropic noise.</strong><br>
We assume Gaussian, additive, and isotropic noise. Biological noise is
often state-dependent, bursty, or non-Gaussian, and may involve
correlations across genes. Extending rareflow to multiplicative or
structured noise is possible but requires additional modelling
considerations.</p>
<p><strong>Weak-noise limit.</strong><br>
Freidlin–Wentzell theory describes the asymptotic regime of vanishing
noise. While this provides powerful geometric insights, real biological
systems may operate at intermediate noise levels where subdominant
pathways or entropic effects become relevant.</p>
<p><strong>Deterministic drift known exactly.</strong><br>
In this vignette, the drift function is specified analytically. In real
applications, the drift must be inferred from data, which introduces
uncertainty. rareflow provides tools for such inference, but the quality
of the estimated landscape depends on data density and sampling of rare
transitions.</p>
<p><strong>Single transition pathway.</strong><br>
The minimum action path identifies the dominant transition route under
weak noise. In high-dimensional systems, multiple competing pathways may
coexist, and the FW landscape may exhibit richer topological
structure.</p>
<p>These limitations do not detract from the conceptual value of the
example but highlight the care required when applying landscape-based
interpretations to complex biological data.</p>
</div>
<div class="section level2">
<h2 id="supplementary-information">Supplementary Information<a class="anchor" aria-label="anchor" href="#supplementary-information"></a>
</h2>
<div class="section level3">
<h3 id="s1--freidlinwentzell-action-functional">S1. Freidlin–Wentzell action functional<a class="anchor" aria-label="anchor" href="#s1--freidlinwentzell-action-functional"></a>
</h3>
<p>For an SDE of the form</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>x</mi><mo>=</mo><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mi>d</mi><mi>t</mi><mo>+</mo><msqrt><mi>ε</mi></msqrt><mspace width="0.167em"></mspace><mi>d</mi><msub><mi>W</mi><mi>t</mi></msub><mo>,</mo></mrow><annotation encoding="application/x-tex">
dx = f(x)\,dt + \sqrt{\varepsilon}\,dW_t,
</annotation></semantics></math></p>
<p>the probability of observing a trajectory
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\phi(t)</annotation></semantics></math>
in the limit
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ε</mi><mo>→</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\varepsilon \to 0</annotation></semantics></math>
satisfies a large deviation principle:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ℙ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>≈</mo><mi>ϕ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>≍</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><mfrac><mn>1</mn><mi>ε</mi></mfrac><msub><mi>S</mi><mi>T</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ϕ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
\mathbb{P}(x(t) \approx \phi(t)) \asymp
\exp\left(-\frac{1}{\varepsilon} S_T(\phi)\right),
</annotation></semantics></math></p>
<p>where the action functional is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>T</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ϕ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msubsup><mo>∫</mo><mn>0</mn><mi>T</mi></msubsup><mo stretchy="false" form="postfix">∥</mo><mover><mi>ϕ</mi><mo accent="true">̇</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ϕ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><msup><mo stretchy="false" form="postfix">∥</mo><mn>2</mn></msup><mi>d</mi><mi>t</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">
S_T(\phi) =
\frac{1}{2} \int_0^T \|\dot{\phi}(t) - f(\phi(t))\|^2 dt.
</annotation></semantics></math></p>
<p>The quasipotential between states
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mn>0</mn></msub><annotation encoding="application/x-tex">x_0</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mn>1</mn></msub><annotation encoding="application/x-tex">x_1</annotation></semantics></math>
is defined as</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munder><mo>inf</mo><mrow><mi>T</mi><mo>&gt;</mo><mn>0</mn></mrow></munder><munder><mo>inf</mo><mrow><mi>ϕ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>x</mi><mn>0</mn></msub><mo>,</mo><mspace width="0.278em"></mspace><mi>ϕ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>T</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>x</mi><mn>1</mn></msub></mrow></munder><msub><mi>S</mi><mi>T</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ϕ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
V(x_1) = \inf_{T&gt;0} \inf_{\phi(0)=x_0,\;\phi(T)=x_1} S_T(\phi).
</annotation></semantics></math></p>
<p>This quantity determines the exponential scaling of transition
probabilities and the relative stability of attractors.</p>
</div>
<div class="section level3">
<h3 id="s2--eulerlagrange-equations-for-the-map">S2. Euler–Lagrange equations for the MAP<a class="anchor" aria-label="anchor" href="#s2--eulerlagrange-equations-for-the-map"></a>
</h3>
<p>The minimum action path <span class="math inline">$\phi^\*(t)$</span>
satisfies the Euler–Lagrange equations:</p>
<p><span class="math display">$$
\ddot{\phi}^\*(t)
= \nabla f(\phi^\*(t))^\top
\left(\dot{\phi}^\*(t) - f(\phi^\*(t))\right).
$$</span></p>
<p>rareflow solves this boundary-value problem numerically using a
discretized action functional and gradient-based optimization.</p>
</div>
<div class="section level3">
<h3 id="s3--connection-to-waddingtons-landscape">S3. Connection to Waddington’s landscape<a class="anchor" aria-label="anchor" href="#s3--connection-to-waddingtons-landscape"></a>
</h3>
<p>In the weak-noise limit, the quasipotential plays the role of an
effective potential landscape:</p>
<ul>
<li>minima correspond to stable phenotypes,</li>
<li>saddle points correspond to transition states,</li>
<li>barrier heights determine switching rates.</li>
</ul>
<p>Unlike heuristic potentials, the FW quasipotential is derived from
the underlying dynamics and noise structure, providing a principled
interpretation of cell-fate stability.</p>
</div>
<div class="section level3">
<h3 id="s4--numerical-considerations">S4. Numerical considerations<a class="anchor" aria-label="anchor" href="#s4--numerical-considerations"></a>
</h3>
<ul>
<li>The action functional is discretized using a uniform time grid of
size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">dt</annotation></semantics></math>.</li>
<li>The MAP is optimized using iterative relaxation methods.</li>
<li>The quasipotential is evaluated pointwise by solving a sequence of
MAP problems with varying endpoints.</li>
<li>Convergence depends on smoothness of the drift and appropriate
choice of integration horizon
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math>.</li>
</ul>
<p>These details ensure reproducibility and clarify the mathematical
foundations of the analyses presented in the main vignette.</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>• Freidlin, M. I., &amp; Wentzell, A. D. Random Perturbations of
Dynamical Systems. • Waddington, C. H. The Strategy of the Genes. •
Tzen, B., &amp; Raginsky, M. (2019). Neural stochastic differential
equations and rare events. • Sanov, I. N. (1957). On the probability of
large deviations of random variables.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Pietro Piu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
