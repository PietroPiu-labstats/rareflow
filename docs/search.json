[{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"rareflow: Normalizing Flows for Rare-Event Inference","text":"Rare events outcomes occur extremely small probability often carry significant scientific practical importance. Examples include: transitions metastable states stochastic differential equations (SDEs), deviations empirical distributions expected values, failure events complex systems, tail events biological, physical, financial models. Estimating rare-event probabilities challenging : na√Øve Monte Carlo requires enormous number samples, relevant trajectories atypical, underlying dynamics may high-dimensional nonlinear. rareflow provides unified framework combines: Sanov theory empirical distributions, Girsanov change measure SDEs, Freidlin‚ÄìWentzell large deviations small-noise diffusions, normalizing flows flexible variational inference. package offers modular flow models, variational optimization, specialized wrappers rare-event tilting.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow.html","id":"a-first-example-variational-inference-for-a-discrete-rare-event","dir":"Articles","previous_headings":"","what":"1.A first example: variational inference for a discrete rare event","title":"rareflow: Normalizing Flows for Rare-Event Inference","text":"consider observed empirical distribution: construct planar flow fit variational posterior: computes Evidence Lower Bound (ELBO):","code":"Qobs <- c(0.05, 0.90, 0.05) px <- function(z) c(0.3, 0.4, 0.3) flow <- makeflow(\"planar\", list(u = 0.1, w = 0.2, b = 0)) fit <- fitflowvariational(Qobs, pxgivenz = px, nmc = 500) fit$elbo #> [1] -0.9438972"},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow.html","id":"girsanov-tilting-for-sdes","dir":"Articles","previous_headings":"","what":"2. Girsanov tilting for SDEs","title":"rareflow: Normalizing Flows for Rare-Event Inference","text":"Consider SDE: simulate Brownian increments: Define drift tilt: can fit tilted variational model using wrapper:","code":"b <- function(x) -x dt <- 0.01 T <- 1000 set.seed(1) Winc <- rnorm(T, sd = sqrt(dt)) theta <- rep(0.5, T) girsanov_logratio(theta, Winc, dt) #> [1] -1.832407 set.seed(123) dt  <- 0.01 T   <- 1000 Winc <- rnorm(T, sd = sqrt(dt)) theta_path <- rep(0, length(Winc)) fit_gir <- fitflow_girsanov(   observed      = Qobs,   base_pxgivenz = px,   theta_path    = theta_path,   Winc          = Winc,   dt            = dt )"},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow.html","id":"freidlinwentzell-quasi-potential","dir":"Articles","previous_headings":"","what":"3. Freidlin‚ÄìWentzell quasi-potential","title":"rareflow: Normalizing Flows for Rare-Event Inference","text":"small-noise diffusions form: dXt=b(Xt)dt+ŒµdWt, dX_t = b(X_t)\\, dt + \\sqrt{\\varepsilon}\\, dW_t, rare transitions governed Freidlin‚ÄìWentzell action: S[x]=12‚à´0T‚à•x‚Ä≤(t)‚àíb(x(t))‚à•2dt. S[x] = \\frac{1}{2} \\int_0^T \\| x'(t) - b(x(t)) \\|^2 \\, dt.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow.html","id":"double-well-potential","dir":"Articles","previous_headings":"3. Freidlin‚ÄìWentzell quasi-potential","what":"Double-well potential","title":"rareflow: Normalizing Flows for Rare-Event Inference","text":"classical double-well potential V(x)=x44‚àíx22, V(x) = \\frac{x^4}{4} - \\frac{x^2}{2}, drift b(x)=‚àíV‚Ä≤(x)=x‚àíx3. b(x) = -V'(x) = x - x^3. visualize potential landscape:  quasi-potential two points aa bb defined minimum action admissible paths connecting : V(,b)=infx(0)=,x(T)=bS[x]. V(, b) = \\inf_{x(0)=,\\, x(T)=b} S[x]. compute quasi-potential two points: Plot minimum-action path:","code":"V <- function(x) x^4/4 - x^2/2 xs <- seq(-2, 2, length.out = 400)  plot(xs, V(xs), type = \"l\", lwd = 2,      main = \"Double-Well Potential\",      ylab = \"V(x)\", xlab = \"x\") abline(v = c(-1, 1), lty = 3, col = \"gray\") b<- function(x) {   v<- as.numeric(x)   return(c(v - v^3)) #double-well drift } qp<- FW_quasipotential(-1, 1, drift = b, T = 200, dt = 0.01) qp$action #> [1] 132900.4 plot(qp$path, type = \"l\", main = \"Minimum-Action Path (Freidlin‚ÄìWentzell)\")"},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow.html","id":"two-dimensional-example-radial-double-well","dir":"Articles","previous_headings":"","what":"3.1 Two-dimensional example: radial double-well","title":"rareflow: Normalizing Flows for Rare-Event Inference","text":"consider 2D potential V(x,y)=14(x2+y2‚àí1)2, V(x,y) = \\frac{1}{4}(x^2 + y^2 - 1)^2, whose minima form ring radius 1. drift b(x,y)=‚àí(x2+y2‚àí1)(x,y). b(x,y) = -(x^2 + y^2 - 1)(x, y). visualize potential landscape: simulate 2D diffusion: dXt=b(Xt)dt+ŒµdWt. dX_t = b(X_t)\\, dt + \\sqrt{\\varepsilon}\\, dW_t.","code":"V2 <- function(x, y) 0.25 * (x^2 + y^2 - 1)^2  xs <- seq(-2, 2, length.out = 200) ys <- seq(-2, 2, length.out = 200) grid <- expand.grid(x = xs, y = ys) Z <- matrix(V2(grid$x, grid$y), nrow = length(xs))  contour(xs, ys, Z,         nlevels = 20,         main = \"2D Radial Double-Well Potential\",         xlab = \"x\", ylab = \"y\") dt <- 0.01 T <- 5000 x <- matrix(0, nrow = T, ncol = 2)  b2 <- function(v) {   r2 <- sum(v^2)   -(r2 - 1) * v }  for (t in 1:(T-1)) {   drift <- b2(x[t, ])   noise <- sqrt(dt) * rnorm(2)   x[t+1, ] <- x[t, ] + drift * dt + noise }  plot(x[,1], x[,2], type = \"l\",      main = \"2D Diffusion in a Radial Double-Well\",      xlab = \"x\", ylab = \"y\")"},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow.html","id":"minimum-action-path-in-2d-string-method","dir":"Articles","previous_headings":"3.1 Two-dimensional example: radial double-well","what":"3.2 Minimum Action Path in 2D (String Method)","title":"rareflow: Normalizing Flows for Rare-Event Inference","text":"compute 2D Freidlin‚ÄìWentzell minimum-action path using simple string-method iteration. consider radial double-well potential: V(x,y)=14(x2+y2‚àí1)2,b(x,y)=‚àí‚àáV(x,y)=‚àí(x2+y2‚àí1)(x,y). V(x,y) = \\frac{1}{4}(x^2 + y^2 - 1)^2, \\qquad b(x,y) = -\\nabla V(x,y) = -(x^2 + y^2 - 1)(x, y). compute MAP points (‚àí1,0)(-1,0) (1,0)(1,0).","code":"# Potential and drift V2 <- function(x, y) 0.25 * (x^2 + y^2 - 1)^2 b2 <- function(v) {   r2 <- sum(v^2)   -(r2 - 1) * v }  # String method parameters N <- 80          # number of points in the string steps <- 200     # number of iterations dt_sm <- 0.01    # step size  # Initial straight-line path path <- cbind(seq(-1, 1, length.out = N), rep(0, N))  # String method iterations for (k in 1:steps) {   # Update each interior point   for (i in 2:(N-1)) {     drift <- b2(path[i, ])     path[i, ] <- path[i, ] + dt_sm * drift   }      # Reparametrize to keep points evenly spaced   d <- sqrt(rowSums(diff(path)^2))   s <- c(0, cumsum(d))   s <- s / max(s)   path <- cbind(     approx(s, path[,1], xout = seq(0,1,length.out=N))$y,     approx(s, path[,2], xout = seq(0,1,length.out=N))$y   ) }  plot(path[,1], path[,2], type=\"l\", lwd=2,      main=\"2D Minimum Action Path (String Method)\",      xlab=\"x\", ylab=\"y\") points(c(-1,1), c(0,0), pch=19, col=\"red\") library(ggplot2) library(gganimate) #> No renderer backend detected. gganimate will default to writing frames to separate files #> Consider installing: #> - the `gifski` package for gif output #> - the `av` package for video output #> and restarting the R session"},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow.html","id":"animation-of-a-2d-diffusion-trajectory","dir":"Articles","previous_headings":"3.1 Two-dimensional example: radial double-well","what":"3.3 Animation of a 2D diffusion trajectory","title":"rareflow: Normalizing Flows for Rare-Event Inference","text":"animate 2D trajectory simulated radial double-well potential.","code":"# Simulate a 2D trajectory dt <- 0.01 T <- 2000 x <- matrix(0, nrow = T, ncol = 2)  for (t in 1:(T-1)) {   drift <- b2(x[t, ])   noise <- sqrt(dt) * rnorm(2)   x[t+1, ] <- x[t, ] + drift * dt + noise }  df <- data.frame(   t = 1:T,   x = x[,1],   y = x[,2] )  p <- ggplot(df, aes(x, y)) +   geom_path(alpha = 0.4) +   geom_point(aes(frame = t), color = \"red\", size = 2) +   coord_equal() +   labs(title = \"2D Diffusion Trajectory\", x = \"x\", y = \"y\")  animate(p, nframes = 200, fps = 20)"},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow.html","id":"full-workflow-bistable-diffusion-and-rare-event-estimation","dir":"Articles","previous_headings":"","what":"4. Full workflow: bistable diffusion and rare-event estimation","title":"rareflow: Normalizing Flows for Rare-Event Inference","text":"simulate bistable diffusion: Define rare event: reaching right well. Construct empirical distribution: Fit variational flow:","code":"b <- function(x) x - x^3 dt <- 0.01 T <- 2000 x <- numeric(T) for (t in 1:(T-1)) {   x[t+1] <- x[t] + b(x[t])*dt + sqrt(dt)*rnorm(1) } rare_event <- mean(x > 1.5) rare_event #> [1] 0.0505 Qobs <- c(mean(x < -0.5), mean(abs(x) <= 0.5), mean(x > 0.5)) px <- function(z) c(0.3, 0.4, 0.3) fit <- fitflowvariational(Qobs, pxgivenz = px) fit$elbo #> [1] -1.127451"},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow.html","id":"conclusions","dir":"Articles","previous_headings":"","what":"Conclusions","title":"rareflow: Normalizing Flows for Rare-Event Inference","text":"rareflow provides: unified interface rare-event modeling, modular normalizing flows, variational inference tools, Girsanov Freidlin‚ÄìWentzell utilities. Future extensions may include: minimum action method (MAM), string method, multidimensional examples, built-datasets.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"rareflow: Normalizing Flows for Rare-Event Inference","text":"Dembo, ., & Zeitouni, O. (1998). Large Deviations Techniques Applications. Springer. Oksendal, B. (2003). Stochastic Differential Equations: Introduction Applications. Springer. Freidlin, M. ., & Wentzell, . D. (2012). Random Perturbations Dynamical Systems. Springer.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow_biology.html","id":"simple-eulermaruyama-sde-simulator","dir":"Articles","previous_headings":"","what":"Simple Euler‚ÄìMaruyama SDE simulator","title":"Cell-fate transitions as rare events","text":"","code":"simulate_sde <- function(f, x0, dt, n, sigma) {   d <- length(x0)   X <- matrix(0, n, d)   X[1, ] <- x0      for (i in 2:n) {     drift <- f(X[i - 1, ])     noise <- rnorm(d, mean = 0, sd = sqrt(dt))     X[i, ] <- X[i - 1, ] + drift * dt + sigma * noise   }      list(X = X) }"},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow_biology.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Cell-fate transitions as rare events","text":"Cell-fate decisions developmental biology often emerge interplay nonlinear gene regulatory networks intrinsic biological noise. Cells may reside metastable progenitor states committing one several differentiated phenotypes. transitions rare events, driven fluctuations push system across energetic barriers separating stable attractors. vignette, show rareflow can used : - reconstruct Freidlin‚ÄìWentzell quasipotential bistable gene regulatory network - identify stable phenotypes metastable progenitor states - compute minimum action path (MAP) representing probable differentiation trajectory - quantify barrier height separating cell fates provides computational analogue classical Waddington epigenetic landscape.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow_biology.html","id":"a-bistable-gene-regulatory-network","dir":"Articles","previous_headings":"","what":"A bistable gene regulatory network","title":"Cell-fate transitions as rare events","text":"consider minimal 2-gene system mutual inhibition: system exhibits: - two stable attractors (phenotypes B) - one metastable state near origin (progenitor M) - rare noise-induced transitions states","code":"f <- function(x) {   alpha <- 0.6   c(     x[1] - x[1]^3 - alpha * x[2],     x[2] - x[2]^3 - alpha * x[1]   ) }"},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow_biology.html","id":"simulating-stochastic-trajectories","dir":"Articles","previous_headings":"","what":"Simulating stochastic trajectories","title":"Cell-fate transitions as rare events","text":"simulate trajectory starting near progenitor state.","code":"set.seed(1)  sim <- simulate_sde(   f = f,   x0 = c(0.1, 0.1),   dt = 0.01,   n = 5000,   sigma = 0.2 )  df <- as.data.frame(sim$X) colnames(df) <- c(\"x1\", \"x2\") df$time <- seq_len(nrow(df)) #ggplot(df, aes(x1, x2, color = time)) + #  geom_path(alpha = 0.7) + #  scale_color_viridis_c() + #  theme_minimal() + #  labs(title = \"Stochastic trajectory in gene expression space\")"},{"path":[]},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow_biology.html","id":"freidlinwentzell-quasipotential","dir":"Articles","previous_headings":"Fitting a Freidlin‚ÄìWentzell model with rareflow","what":"Freidlin‚ÄìWentzell quasipotential","title":"Cell-fate transitions as rare events","text":"directly compute Freidlin‚ÄìWentzell quasipotential progenitor state M differentiated state .","code":"x0 <- c(0, 0)       # progenitor state M x1 <- c(1, -0.5)    # phenotype A  qp <- FW_quasipotential(   x0 = x0,   x1 = x1,   drift = f,   T = 200,   dt = 0.01 )"},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow_biology.html","id":"schematic-epigenetic-landscape-2d-contour","dir":"Articles","previous_headings":"","what":"Schematic epigenetic landscape (2D contour)","title":"Cell-fate transitions as rare events","text":"","code":"x_seq <- seq(-2, 2, length.out = 30) y_seq <- seq(-2, 2, length.out = 30)  landscape_grid <- expand.grid(x = x_seq, y = y_seq)  # Evaluate quasipotential on grid V_vals <- apply(landscape_grid, 1, function(z) {   FW_quasipotential(     x0 = x0,     x1 = z,     drift = f,     T = 200,     dt = 0.01   )$action })  landscape_grid$V <- V_vals  #ggplot(landscape_grid, aes(x, y, z = V)) + #  geom_contour_filled(bins = 20) + #  scale_fill_viridis_d() + #  theme_minimal() + #  labs(title = \"Schematic epigenetic landscape (FW quasipotential)\")"},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow_biology.html","id":"minimum-action-path-the-most-probable-differentiation-trajectory","dir":"Articles","previous_headings":"","what":"Minimum action path: the most probable differentiation trajectory","title":"Cell-fate transitions as rare events","text":"compute MAP progenitor state M phenotype .","code":"path_MA <- FW_minimum_action_path(   x0 = x0,   x1 = x1,   drift = f,   T = 200,   dt = 0.01 )  # Extract the path matrix (robust to different internal structures) path_matrix <- NULL  if (is.matrix(path_MA)) {   path_matrix <- path_MA } else if (\"path\" %in% names(path_MA)) {   path_matrix <- path_MA$path } else if (\"X\" %in% names(path_MA)) {   path_matrix <- path_MA$X } else {   stop(\"Cannot find trajectory matrix in FW_minimum_action_path() output.\") }  path_df <- as.data.frame(path_matrix) colnames(path_df) <- c(\"x1\", \"x2\") path_df$step <- seq_len(nrow(path_df))  #ggplot(path_df, aes(x1, x2)) + #  theme_minimal() + # lab(title = \"Minimum action path (MAP)\")"},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow_biology.html","id":"overlay-map-on-the-fw-landscape","dir":"Articles","previous_headings":"","what":"Overlay MAP on the FW landscape","title":"Cell-fate transitions as rare events","text":"","code":"path_df <- as.data.frame(path_matrix) colnames(path_df) <- c(\"x1\", \"x2\")  #ggplot(landscape_grid, aes(x, y, z = V)) + #  geom_contour_filled(bins = 20, alpha = 0.8) + #  scale_fill_viridis_d() + #  geom_path(data = path_df, aes(x1, x2), #            color = \"red\", size = 1.2, inherit.aes = FALSE #) + #  theme_minimal() + #  labs(title = \"Minimum action path over the epigenetic landscape\") library(ggplot2) library(viridis) library(patchwork) library(dplyr) library(grid)  # ---- Directional Arrows on MAP ---- path_df_arrows <- path_df %>%   mutate(x1_next = lead(x1), x2_next = lead(x2)) %>%   filter(!is.na(x1_next))  # ---- Nature-style Theme ---- theme_nature <- theme_minimal(base_size = 12) +   theme(     plot.title = element_text(face = \"bold\", size = 14),     plot.subtitle = element_text(size = 10, margin = margin(b = 5)),     axis.title = element_text(size = 11),     axis.text = element_text(size = 10),     legend.position = \"right\",     panel.grid.minor = element_blank()   )  # ---- Panel A: Stochastic Trajectory---- pA <- ggplot(df, aes(x1, x2, color = time)) +   geom_path(alpha = 0.7, size = 0.6) +   scale_color_viridis_c() +   theme_nature +   labs(     title = \"A. Stochastic trajectory\",     subtitle = \"Noise-driven excursions around the progenitor state\",     color = \"Time\"   )  # ---- Panel B: FW Landscape---- pB <- ggplot(landscape_grid, aes(x, y, z = V)) +   geom_contour_filled(bins = 20) +   scale_fill_viridis_d(option = \"mako\") +   theme_nature +   theme(     legend.position = \"bottom\",     legend.key.width = unit(1.2, \"cm\"),     legend.key.height = unit(0.4, \"cm\"),     legend.title = element_text(size = 10),     legend.text = element_text(size = 9),     plot.margin = margin(t = 20, r = 10, b = 15, l = 10)   ) +   labs(     title = \"B. Epigenetic landscape (FW quasipotential)\",     subtitle = \"Dark basins = stable phenotypes; shallow region = progenitor state\",     fill = \"V(x)\"   )  # ---- Panel C: MAP ---- pC <- ggplot(path_df, aes(x1, x2)) +   geom_path(color = \"red\", size = 1) +   geom_segment(     data = path_df_arrows,     aes(x = x1, y = x2, xend = x1_next, yend = x2_next),     arrow = arrow(type = \"closed\", length = unit(0.15, \"cm\")),     color = \"red\"   ) +   theme_nature +   labs(     title = \"C. Minimum action path (MAP)\",     subtitle = \"Most probable transition trajectory under weak noise\"   )  # ---- Panel D: MAP + Landscape ---- pD <- ggplot(landscape_grid, aes(x, y, z = V)) +   geom_contour_filled(bins = 20, alpha = 0.85) +   scale_fill_viridis_d(option = \"mako\") +   geom_path(     data = path_df,     aes(x = x1, y = x2),     color = \"red\", size = 1.2,     inherit.aes = FALSE   ) +   geom_segment(     data = path_df_arrows,     aes(x = x1, y = x2, xend = x1_next, yend = x2_next),     arrow = arrow(type = \"closed\", length = unit(0.15, \"cm\")),     color = \"red\",     inherit.aes = FALSE   ) +   theme_nature +   theme(     legend.position = \"bottom\",     legend.key.width = unit(1.2, \"cm\"),     legend.key.height = unit(0.4, \"cm\"),     legend.title = element_text(size = 10),     legend.text = element_text(size = 9),     plot.margin = margin(t = 20, r = 10, b = 15, l = 10)   ) +   labs(     title = \"D. MAP over the FW landscape\",     subtitle = \"The MAP crosses the saddle region: the most probable transition point\",     fill = \"V(x)\"   )  # ---- Final 2√ó2 composition---- (pA | pB) / (pC | pD)"},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow_biology.html","id":"biological-interpretation","dir":"Articles","previous_headings":"","what":"Biological interpretation","title":"Cell-fate transitions as rare events","text":"example illustrates rareflow can used : ‚Ä¢ reconstruct data-driven epigenetic landscape ‚Ä¢ identify stable phenotypes minima quasipotential ‚Ä¢ quantify barrier heights cell fates ‚Ä¢ compute probable differentiation trajectories ‚Ä¢ study noise shapes developmental decisions analyses relevant : ‚Ä¢ single-cell transcriptomics ‚Ä¢ developmental biology ‚Ä¢ cell reprogramming ‚Ä¢ gene regulatory network inference","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow_biology.html","id":"biological-insights","dir":"Articles","previous_headings":"","what":"Biological insights","title":"Cell-fate transitions as rare events","text":"bistable system explored vignette captures recurring motif developmental biology: cell-fate decisions emerging noisy regulatory dynamics. Although model minimal, qualitative structure mirrors behaviour real gene regulatory networks involved differentiation, reprogramming, lineage commitment.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow_biology.html","id":"the-quasipotential-as-an-epigenetic-landscape","dir":"Articles","previous_headings":"Biological insights","what":"The quasipotential as an epigenetic landscape","title":"Cell-fate transitions as rare events","text":"Freidlin‚ÄìWentzell quasipotential computed provides quantitative analogue Waddington‚Äôs epigenetic landscape. representation: deep minima correspond stable phenotypes (B), shallow basin near origin represents metastable progenitor state (M), saddle region basins encodes energetic difficulty switching fate. Unlike heuristic drawings Waddington‚Äôs landscape, FW quasipotential derived directly underlying dynamics noise structure. therefore captures intrinsic fluctuations shape accessibility different phenotypic states.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow_biology.html","id":"noise-driven-transitions-and-developmental-variability","dir":"Articles","previous_headings":"Biological insights","what":"Noise-driven transitions and developmental variability","title":"Cell-fate transitions as rare events","text":"biological systems, noise merely nuisance: can actively drive rare transitions enable cells explore alternative fates. minimum action path (MAP) computed rareflow represents probable trajectory cell follows committing new phenotype weak noise. trajectory arbitrary. reflects: geometry regulatory network, relative stability competing attractors, direction fluctuations effective pushing system. developmental contexts, MAPs correspond canalized differentiation routes, cells follow reproducible paths despite stochasticity.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow_biology.html","id":"barrier-heights-and-phenotypic-stability","dir":"Articles","previous_headings":"Biological insights","what":"Barrier heights and phenotypic stability","title":"Cell-fate transitions as rare events","text":"height FW barrier separating M B provides natural measure phenotypic stability. higher barrier implies: stronger resistance noise-induced switching, longer residence times given state, greater robustness phenotype. concept central understanding: cell types stable long timescales, progenitor states plastic, perturbations (mutations, signalling cues) reshape developmental trajectories.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow_biology.html","id":"broader-implications","dir":"Articles","previous_headings":"Biological insights","what":"Broader implications","title":"Cell-fate transitions as rare events","text":"Although vignette uses simple 2-gene model, principles apply high-dimensional single-cell transcriptomic data, rareflow can help: infer effective landscapes observed trajectories, quantify transition probabilities cell states, identify lineage bifurcations, compare wild-type perturbed conditions. sense, rareflow provides computational bridge stochastic dynamical systems theory modern single-cell biology, enabling data-driven reconstructions landscapes govern cellular identity.","code":""},{"path":[]},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow_biology.html","id":"stochastic-gene-regulatory-model","dir":"Articles","previous_headings":"Methods","what":"Stochastic gene regulatory model","title":"Cell-fate transitions as rare events","text":"model minimal two-gene regulatory circuit mutual inhibition, common motif developmental systems. dynamics gene expression levels x=(x1,x2)x = (x_1, x_2) follow stochastic differential equation (SDE): dx=f(x)dt+œÉdWt, dx = f(x)\\,dt + \\sigma\\,dW_t, WtW_t two-dimensional Wiener process œÉ\\sigma controls noise amplitude. drift term encodes self-activation cross-repression: f(x1,x2)=(x1‚àíx13‚àíŒ±x2x2‚àíx23‚àíŒ±x1), f(x_1, x_2) = \\begin{pmatrix} x_1 - x_1^3 - \\alpha x_2 \\\\ x_2 - x_2^3 - \\alpha x_1 \\end{pmatrix}, Œ±=0.6\\alpha = 0.6. system exhibits two stable attractors corresponding differentiated phenotypes metastable state near origin representing progenitor cell.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow_biology.html","id":"numerical-simulation-of-stochastic-trajectories","dir":"Articles","previous_headings":"Methods","what":"Numerical simulation of stochastic trajectories","title":"Cell-fate transitions as rare events","text":"Stochastic trajectories generated using Euler‚ÄìMaruyama scheme time step dt=0.01dt = 0.01 noise amplitude œÉ=0.2\\sigma = 0.2. simulator implements: xt+dt=xt+f(xt)dt+œÉdtŒæt, x_{t+dt} = x_t + f(x_t)\\,dt + \\sigma \\sqrt{dt}\\,\\xi_t, Œæt‚àºùí©(0,I2)\\xi_t \\sim \\mathcal{N}(0, I_2). Trajectories length 5000 steps used illustrate noise-induced excursions around metastable region.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow_biology.html","id":"freidlinwentzell-quasipotential-1","dir":"Articles","previous_headings":"Methods","what":"Freidlin‚ÄìWentzell quasipotential","title":"Cell-fate transitions as rare events","text":"quantify stability landscape underlying dynamics, compute Freidlin‚ÄìWentzell (FW) quasipotential V(x)V(x), defined minimal action required system transition initial state x0x_0 target state xx vanishing noise: V(x)=infœï:œï(0)=x0,œï(T)=x12‚à´0T‚à•œïÃá(t)‚àíf(œï(t))‚à•2dt. V(x) = \\inf_{\\phi: \\phi(0)=x_0,\\, \\phi(T)=x} \\frac{1}{2} \\int_0^T \\|\\dot{\\phi}(t) - f(\\phi(t))\\|^2 dt. quasipotential computed using FW_quasipotential() function rareflow, integration horizon T=200T = 200 time step dt=0.01dt = 0.01. yields scalar field whose minima correspond stable phenotypes whose saddle regions quantify transition barriers.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow_biology.html","id":"minimum-action-path-map","dir":"Articles","previous_headings":"Methods","what":"Minimum action path (MAP)","title":"Cell-fate transitions as rare events","text":"probable transition trajectory two states weak noise given minimum action path (MAP), defined curve $\\phi^\\*$ minimizes FW action functional. MAP satisfies Euler‚ÄìLagrange equations associated FW functional represents dominant transition pathway low-noise limit. compute MAP using FW_minimum_action_path() integration parameters . resulting trajectory interpolated visualized quasipotential landscape illustrate canalized route differentiation.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow_biology.html","id":"landscape-visualization","dir":"Articles","previous_headings":"Methods","what":"Landscape visualization","title":"Cell-fate transitions as rare events","text":"FW quasipotential evaluated two-dimensional grid spanning [‚àí2,2]2[-2, 2]^2. Contour plots generated using ggplot2 produce schematic epigenetic landscape. MAP overlaid contour map highlight relationship landscape geometry transition dynamics. computations performed using rareflow package (version X.X.X) R.","code":""},{"path":[]},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow_biology.html","id":"limitations-and-assumptions","dir":"Articles","previous_headings":"","what":"Limitations and assumptions","title":"Cell-fate transitions as rare events","text":"model analyses presented vignette intentionally minimal serve primarily conceptual demonstration rareflow can applied biological systems. Several simplifying assumptions noted. Low-dimensional dynamics. two-gene regulatory network used captures qualitative structure bistability reflect high dimensionality real transcriptional regulatory systems. practice, cell-fate decisions involve dozens hundreds interacting genes, effective landscape may substantially complex. Additive, isotropic noise. assume Gaussian, additive, isotropic noise. Biological noise often state-dependent, bursty, non-Gaussian, may involve correlations across genes. Extending rareflow multiplicative structured noise possible requires additional modelling considerations. Weak-noise limit. Freidlin‚ÄìWentzell theory describes asymptotic regime vanishing noise. provides powerful geometric insights, real biological systems may operate intermediate noise levels subdominant pathways entropic effects become relevant. Deterministic drift known exactly. vignette, drift function specified analytically. real applications, drift must inferred data, introduces uncertainty. rareflow provides tools inference, quality estimated landscape depends data density sampling rare transitions. Single transition pathway. minimum action path identifies dominant transition route weak noise. high-dimensional systems, multiple competing pathways may coexist, FW landscape may exhibit richer topological structure. limitations detract conceptual value example highlight care required applying landscape-based interpretations complex biological data.","code":""},{"path":[]},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow_biology.html","id":"s1--freidlinwentzell-action-functional","dir":"Articles","previous_headings":"Supplementary Information","what":"S1. Freidlin‚ÄìWentzell action functional","title":"Cell-fate transitions as rare events","text":"SDE form dx=f(x)dt+ŒµdWt, dx = f(x)\\,dt + \\sqrt{\\varepsilon}\\,dW_t, probability observing trajectory œï(t)\\phi(t) limit Œµ‚Üí0\\varepsilon \\0 satisfies large deviation principle: ‚Ñô(x(t)‚âàœï(t))‚âçexp(‚àí1ŒµST(œï)), \\mathbb{P}(x(t) \\approx \\phi(t)) \\asymp \\exp\\left(-\\frac{1}{\\varepsilon} S_T(\\phi)\\right), action functional ST(œï)=12‚à´0T‚à•œïÃá(t)‚àíf(œï(t))‚à•2dt. S_T(\\phi) = \\frac{1}{2} \\int_0^T \\|\\dot{\\phi}(t) - f(\\phi(t))\\|^2 dt. quasipotential states x0x_0 x1x_1 defined V(x1)=infT>0infœï(0)=x0,œï(T)=x1ST(œï). V(x_1) = \\inf_{T>0} \\inf_{\\phi(0)=x_0,\\;\\phi(T)=x_1} S_T(\\phi). quantity determines exponential scaling transition probabilities relative stability attractors.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow_biology.html","id":"s2--eulerlagrange-equations-for-the-map","dir":"Articles","previous_headings":"Supplementary Information","what":"S2. Euler‚ÄìLagrange equations for the MAP","title":"Cell-fate transitions as rare events","text":"minimum action path $\\phi^\\*(t)$ satisfies Euler‚ÄìLagrange equations: $$ \\ddot{\\phi}^\\*(t) = \\nabla f(\\phi^\\*(t))^\\top \\left(\\dot{\\phi}^\\*(t) - f(\\phi^\\*(t))\\right). $$ rareflow solves boundary-value problem numerically using discretized action functional gradient-based optimization.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow_biology.html","id":"s3--connection-to-waddingtons-landscape","dir":"Articles","previous_headings":"Supplementary Information","what":"S3. Connection to Waddington‚Äôs landscape","title":"Cell-fate transitions as rare events","text":"weak-noise limit, quasipotential plays role effective potential landscape: minima correspond stable phenotypes, saddle points correspond transition states, barrier heights determine switching rates. Unlike heuristic potentials, FW quasipotential derived underlying dynamics noise structure, providing principled interpretation cell-fate stability.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow_biology.html","id":"s4--numerical-considerations","dir":"Articles","previous_headings":"Supplementary Information","what":"S4. Numerical considerations","title":"Cell-fate transitions as rare events","text":"action functional discretized using uniform time grid size dtdt. MAP optimized using iterative relaxation methods. quasipotential evaluated pointwise solving sequence MAP problems varying endpoints. Convergence depends smoothness drift appropriate choice integration horizon TT. details ensure reproducibility clarify mathematical foundations analyses presented main vignette.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow_biology.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Cell-fate transitions as rare events","text":"‚Ä¢ Freidlin, M. ., & Wentzell, . D. Random Perturbations Dynamical Systems. ‚Ä¢ Waddington, C. H. Strategy Genes. ‚Ä¢ Tzen, B., & Raginsky, M. (2019). Neural stochastic differential equations rare events. ‚Ä¢ Sanov, . N. (1957). probability large deviations random variables.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow_neuroscience.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Rare spiking patterns in the Izhikevich neuron: a large deviations perspective","text":"Izhikevich neuron model one elegant versatile models computational neuroscience. PhD Neuroscience University Siena, pleasure attending seminar Eugene Izhikevich ‚Äî experience left lasting impression think neuronal dynamics. vignette, explore rare spiking patterns Izhikevich neuron using rareflow package. Unlike biology vignette, focused Freidlin‚ÄìWentzell quasipotentials minimum action paths, adopt large deviations perspective observables, specifically firing rate time window. approach connects naturally ideas discussed blog post‚ÄúSanov‚Äôs theorem living systems‚Äù.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow_neuroscience.html","id":"the-izhikevich-model","dir":"Articles","previous_headings":"","what":"The Izhikevich model","title":"Rare spiking patterns in the Izhikevich neuron: a large deviations perspective","text":"consider standard 2D Izhikevich neuron: vÃá=0.04v2+5v+140‚àíu++œÉŒæt \\dot v = 0.04v^2 + 5v + 140 - u + + \\sigma \\xi_t uÃá=(bv‚àíu) \\dot u = (bv - u) reset condition: v‚â•30‚áív‚Üêc,u‚Üêu+d. v \\ge 30 \\Rightarrow v \\leftarrow c,\\quad u \\leftarrow u + d. choose parameters corresponding tonic spiking near bifurcation, noise can induce rare excursions firing rate:","code":"a <- 0.02 b <- 0.2 c <- -65 d <- 8 I_mean <- 10 sigma <- 2"},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow_neuroscience.html","id":"observable-firing-rate-over-a-time-window","dir":"Articles","previous_headings":"","what":"Observable: firing rate over a time window","title":"Rare spiking patterns in the Izhikevich neuron: a large deviations perspective","text":"define empirical firing rate time window TT RT=N(T)T, R_T = \\frac{N(T)}{T}, N(T)N(T) number spikes interval [0,T][0, T]. observable ideal Sanov-type large deviations analysis: rare events correspond unusually high (low) firing rates.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow_neuroscience.html","id":"stochastic-simulations","dir":"Articles","previous_headings":"","what":"Stochastic simulations","title":"Rare spiking patterns in the Izhikevich neuron: a large deviations perspective","text":"simulate many stochastic trajectories Izhikevich neuron adding noise input current: extract spike times compute empirical distribution R_T.","code":"library(dplyr) library(tidyr) library(purrr)  # --- Parameters --- a <- 0.02 b <- 0.2 c <- -65 d <- 8  I_mean <- 10      # baseline input current sigma  <- 2       # noise intensity  dt <- 0.1         # time step (ms) Tmax <- 2000      # total simulation time (ms) time <- seq(0, Tmax, by = dt)  n_trials <- 200   # number of stochastic trajectories  # --- Function to simulate one stochastic trajectory --- simulate_izhikevich <- function() {   v <- -65   u <- b * v   I <- I_mean      v_trace <- numeric(length(time))   spikes  <- numeric(length(time))      for (i in seq_along(time)) {          # noisy input current     I_noise <- I + sigma * rnorm(1, 0, sqrt(dt))          # Euler-Maruyama update     dv <- 0.04*v^2 + 5*v + 140 - u + I_noise     du <- a*(b*v - u)          v <- v + dv * dt     u <- u + du * dt          # spike condition     if (v >= 30) {       v_trace[i] <- 30       spikes[i]  <- 1       v <- c       u <- u + d     } else {       v_trace[i] <- v     }   }      tibble(     time = time,     v = v_trace,     spike = spikes   ) }  # --- Simulate multiple trajectories --- set.seed(123) sim_list <- replicate(n_trials, simulate_izhikevich(), simplify = FALSE)  # Add trial index sim_df <- bind_rows(   lapply(seq_along(sim_list), function(i) mutate(sim_list[[i]], trial = i)) )"},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow_neuroscience.html","id":"large-deviations-analysis-with-rareflow","dir":"Articles","previous_headings":"","what":"Large deviations analysis with rareflow","title":"Rare spiking patterns in the Izhikevich neuron: a large deviations perspective","text":"Using empirical distribution firing rates, estimate: tail probability unusually high firing rates rate function associated observable large deviations scaling function time window T","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow_neuroscience.html","id":"rareflow-analysis-on-the-empirical-observable","dir":"Articles","previous_headings":"","what":"Rareflow analysis on the empirical observable","title":"Rare spiking patterns in the Izhikevich neuron: a large deviations perspective","text":"summarize analysis four-panel composite figure: . Example voltage trace spikes B. Empirical distribution firing rate C. rareflow-based tail estimate rate function D. Comparison empirical rareflow predictions","code":"library(dplyr)  # --- Define observation window --- T_window <- 500   # ms n_windows <- floor(Tmax / T_window)  # Compute firing rate per window per trial rate_df <- sim_df %>%   group_by(trial) %>%   mutate(window = floor(time / T_window)) %>%   group_by(trial, window) %>%   summarise(     spikes = sum(spike),     rate = spikes / (T_window / 1000),   # spikes per second     .groups = \"drop\"   )  # Empirical distribution of firing rate empirical_rates <- rate_df$rate  # --- Empirical tail probability --- tail_df <- rate_df %>%   summarise(rate = rate) %>%   arrange(rate) %>%   mutate(     tail_prob = rev(cumsum(rev(rep(1/n(), n()))))   )"},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow_neuroscience.html","id":"figure","dir":"Articles","previous_headings":"","what":"Figure","title":"Rare spiking patterns in the Izhikevich neuron: a large deviations perspective","text":"Figure 1. Rare spiking patterns Izhikevich neuron noisy input.. Example voltage trace single stochastic trial Izhikevich neuron tonic‚Äëspiking regime. Noise injected input current, producing variability inter‚Äëspike intervals occasional deviations regular firing pattern. panel illustrates dynamical substrate firing‚Äërate observable extracted. B. Empirical distribution firing rate RTR_T computed windows length T=500T = 500 ms across stochastic trials. distribution unimodal exhibits noticeable right tail, corresponding episodes transient hyperactivity induced noise. high‚Äërate events ‚Äúrare events‚Äù interest large‚Äëdeviations analysis. C. Empirical tail probability P(RT‚â•x)P(R_T \\ge x) function firing‚Äërate threshold xx. monotonic decay quantifies unlikely neuron exhibit firing rates substantially typical tonic‚Äëspiking level. tail behaviour empirical counterpart large‚Äëdeviations rate function observable RTR_T. D. Comparison empirical firing‚Äërate density (grey) rescaled tail probability (red). overlay highlights relationship bulk distribution rare‚Äëevent structure: density captures typical firing behaviour, tail probability isolates exponentially unlikely excursions high‚Äëactivity regimes.","code":"library(ggplot2) library(patchwork) library(viridis)  # --- Panel A: example voltage trace --- example_trial <- sim_df %>% filter(trial == 1)  pA <- ggplot(example_trial, aes(time, v)) +   geom_line(color = \"black\", size = 0.4) +   theme_minimal() +   labs(     title = \"A. Voltage trace (example trial)\",     subtitle = \"Izhikevich neuron with noisy input\"   )  # --- Panel B: empirical distribution of firing rate --- pB <- ggplot(rate_df, aes(rate)) +   geom_histogram(     bins = 30,     fill = viridis::mako(10)[6],     color = \"white\"   ) +   theme_minimal() +   labs(     title = \"B. Empirical firing rate distribution\",     x = \"Firing rate (Hz)\",     y = \"Count\"   )  # --- Panel C: empirical tail probability --- pC <- ggplot(tail_df, aes(rate, tail_prob)) +   geom_line(color = \"red\", size = 1) +   theme_minimal() +   labs(     title = \"C. Empirical tail probability\",     x = \"Firing rate (Hz)\",     y = \"P(R_T ‚â• x)\"   )  # --- Panel D: empirical density + tail overlay ---  # Compute empirical density outside ggplot dens <- density(empirical_rates) dens_df <- data.frame(x = dens$x, y = dens$y)  # Rescale tail probability to match density scale tail_df$tail_scaled <- tail_df$tail_prob * max(dens_df$y)  pD <- ggplot() +   geom_line(     data = dens_df,     aes(x, y),     color = \"grey40\",     linewidth = 1   ) +   geom_line(     data = tail_df,     aes(rate, tail_scaled),     color = \"red\",     linewidth = 1   ) +   theme_minimal() +   labs(     title = \"D. Empirical density vs tail probability\",     x = \"Firing rate (Hz)\",     y = \"Density\"   )  # --- Combine panels --- (pA | pB) / (pC | pD)"},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow_neuroscience.html","id":"interpretation","dir":"Articles","previous_headings":"","what":"Interpretation","title":"Rare spiking patterns in the Izhikevich neuron: a large deviations perspective","text":"Rare high-firing events correspond noise-driven excursions push neuron transient hyperactivity. large deviations perspective, events exponentially unlikely observation window T, rareflow provides principled way quantify rarity. analysis complements biology vignette showing rareflow can applied state transitions quasipotentials, also functional observables neuronal systems.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/articles/rareflow_neuroscience.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Rare spiking patterns in the Izhikevich neuron: a large deviations perspective","text":"Izhikevich, E. M. (2003). Simple model spiking neurons. IEEE Transactions Neural Networks. Freidlin, M., & Wentzell, . (2012). Random Perturbations Dynamical Systems. Dembo, ., & Zeitouni, O. (1998). Large Deviations Techniques Applications.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Pietro Piu. Author, maintainer.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Piu P (2026). rareflow: Variational Flow-Based Inference Rare Events Large Deviations. R package version 0.1.0, https://pietropiu-labstats.github.io/rareflow/.","code":"@Manual{,   title = {rareflow: Variational Flow-Based Inference for Rare Events and Large Deviations},   author = {Pietro Piu},   year = {2026},   note = {R package version 0.1.0},   url = {https://pietropiu-labstats.github.io/rareflow/}, }"},{"path":"https://pietropiu-labstats.github.io/rareflow/index.html","id":"rareflow-variational-flow-based-inference-for-rare-events","dir":"","previous_headings":"","what":"Variational Flow-Based Inference for Rare Events and Large Deviations","title":"Variational Flow-Based Inference for Rare Events and Large Deviations","text":"Normalizing Flows Rare-Event Inference","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Variational Flow-Based Inference for Rare Events and Large Deviations","text":"rareflow provides unified framework rare-event inference combining: Sanov theory empirical distributions Girsanov change measure SDEs Freidlin‚ÄìWentzell large deviations small-noise diffusions Normalizing flows flexible variational inference package includes: modular flow models (planar, radial, MAF, spline) variational optimization via ELBO wrappers Girsanov tilting FW quasi-potentials tools rare-event simulation analysis","code":""},{"path":[]},{"path":"https://pietropiu-labstats.github.io/rareflow/index.html","id":"from-github","dir":"","previous_headings":"Installation","what":"From GitHub","title":"Variational Flow-Based Inference for Rare Events and Large Deviations","text":"","code":"# install.packages(\"devtools\") devtools::install_github(\"PietroPiu-labstats/rareflow\")"},{"path":"https://pietropiu-labstats.github.io/rareflow/index.html","id":"quick-example","dir":"","previous_headings":"","what":"Quick Example","title":"Variational Flow-Based Inference for Rare Events and Large Deviations","text":"minimal workflow fitting variational posterior using planar flow:","code":"library(rareflow)  Qobs <- c(0.05, 0.90, 0.05) px <- function(z) c(0.3, 0.4, 0.3)  flow <- makeflow(\"planar\") fit <- fitflowvariational(Qobs, pxgivenz = px, nmc = 500)  fit$elbo"},{"path":"https://pietropiu-labstats.github.io/rareflow/index.html","id":"girsanov-tilting","dir":"","previous_headings":"","what":"Girsanov Tilting","title":"Variational Flow-Based Inference for Rare Events and Large Deviations","text":"","code":"b <- function(x) -x dt <- 0.01 T <- 1000 Winc <- rnorm(T, sd = sqrt(dt))  fit_gir <- fitflow_girsanov(   observed = Qobs,   drift = b,   Winc = Winc,   dt = dt,   pxgivenz = px )"},{"path":"https://pietropiu-labstats.github.io/rareflow/index.html","id":"freidlinwentzell-quasi-potential","dir":"","previous_headings":"","what":"Freidlin‚ÄìWentzell Quasi-Potential","title":"Variational Flow-Based Inference for Rare Events and Large Deviations","text":"","code":"b <- function(x) x - x^3 qp <- FW_quasipotential(-1, 1, drift = b, T = 200, dt = 0.01) qp$action"},{"path":"https://pietropiu-labstats.github.io/rareflow/index.html","id":"documentation","dir":"","previous_headings":"","what":"Documentation","title":"Variational Flow-Based Inference for Rare Events and Large Deviations","text":"Full documentation examples available package vignette:","code":"vignette(\"rareflow\")"},{"path":"https://pietropiu-labstats.github.io/rareflow/index.html","id":"features","dir":"","previous_headings":"","what":"Features","title":"Variational Flow-Based Inference for Rare Events and Large Deviations","text":"Variational inference normalizing flows Rare-event tilting via Girsanov Minimum-action paths quasi-potentials Support 1D 2D systems Modular flow architecture","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/ELBOflow.html","id":null,"dir":"Reference","previous_headings":"","what":"Evidence Lower Bound (ELBO) for Flow-Based Variational Inference ‚Äî ELBOflow","title":"Evidence Lower Bound (ELBO) for Flow-Based Variational Inference ‚Äî ELBOflow","text":"Computes ELBO:","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/ELBOflow.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Evidence Lower Bound (ELBO) for Flow-Based Variational Inference ‚Äî ELBOflow","text":"","code":"ELBOflow(flow, Qobs, pxgivenz, nmc = 256)"},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/ELBOflow.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Evidence Lower Bound (ELBO) for Flow-Based Variational Inference ‚Äî ELBOflow","text":"flow flow model created makeflow(). Qobs Observed empirical distribution (probability vector). pxgivenz function mapping latent vector z categorical pmf. nmc Number Monte Carlo samples.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/ELBOflow.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Evidence Lower Bound (ELBO) for Flow-Based Variational Inference ‚Äî ELBOflow","text":"numeric ELBO value.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/ELBOflow.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Evidence Lower Bound (ELBO) for Flow-Based Variational Inference ‚Äî ELBOflow","text":"\\(\\log p(x \\| z) + \\log p(z) - \\log q(z)\\) : q(z) flow-based variational posterior p(z) standard Gaussian prior p(x | z) provided user pxgivenz expectation approximated via Monte Carlo sampling.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/ELBOflow.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Evidence Lower Bound (ELBO) for Flow-Based Variational Inference ‚Äî ELBOflow","text":"","code":"f <- makeflow(\"planar\", list(u = 0.1, w = 0.2, b = 0)) px <- function(z) c(0.3, 0.4, 0.3) ELBOflow(f, Qobs = c(0.2, 0.5, 0.3), pxgivenz = px, nmc = 100) #> [1] -1.061949"},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/fitflowvariational.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit a Flow-Based Variational Posterior for Sanov Inference ‚Äî fitflowvariational","title":"Fit a Flow-Based Variational Posterior for Sanov Inference ‚Äî fitflowvariational","text":"function fits variational posterior q(z) using chosen normalizing flow. objective ELBO:","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/fitflowvariational.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit a Flow-Based Variational Posterior for Sanov Inference ‚Äî fitflowvariational","text":"","code":"fitflowvariational(   observed,   states = NULL,   flowtype = c(\"maf\", \"splinepwlin\", \"planar\", \"radial\"),   flowspec = list(),   inittheta = NULL,   pxgivenz,   nmc = 256,   control = list() )"},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/fitflowvariational.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit a Flow-Based Variational Posterior for Sanov Inference ‚Äî fitflowvariational","text":"observed Observed empirical distribution Q (probability vector). states Optional vector category names. flowtype One \"maf\", \"splinepwlin\", \"planar\", \"radial\". flowspec list specifying structural parameters (d, K, etc.). inittheta Optional initial parameter vector trainable flows. pxgivenz function mapping latent z categorical pmf. nmc Number Monte Carlo samples ELBO estimation. control List control parameters passed optim().","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/fitflowvariational.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit a Flow-Based Variational Posterior for Sanov Inference ‚Äî fitflowvariational","text":"list containing: flow: fitted flow model elbo: final ELBO value theta: optimized parameter vector (applicable) convergence: optim() convergence code","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/fitflowvariational.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fit a Flow-Based Variational Posterior for Sanov Inference ‚Äî fitflowvariational","text":"\\(\\log p(x | z) + \\log p(z) - \\log q(z)\\) flow parameters (theta) optimized via optim() applicable (MAF spline flows). Planar radial flows trainable parameters. function performs generic variational inference using chosen normalizing flow user-provided likelihood pxgivenz. specialized rare-event inference using: Girsanov change measure Freidlin‚ÄìWentzell quasi-potential see wrapper functions: fitflow_girsanov() fitflow_FW() wrappers construct tilted likelihood call fitflowvariational() internally.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/fitflow_FW.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit Flow Using Freidlin‚ÄìWentzell Quasi-Potential ‚Äî fitflow_FW","title":"Fit Flow Using Freidlin‚ÄìWentzell Quasi-Potential ‚Äî fitflow_FW","text":"Computes Freidlin‚ÄìWentzell quasi-potential x0 x1, constructs tilted likelihood proportional exp(-V/eps), fits flow-based variational posterior.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/fitflow_FW.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit Flow Using Freidlin‚ÄìWentzell Quasi-Potential ‚Äî fitflow_FW","text":"","code":"fitflow_FW(   observed,   states = NULL,   flowtype = \"maf\",   flowspec = list(),   inittheta = NULL,   drift,   x0,   x1,   T = 200,   dt = 0.01,   eps = 0.1,   nmc = 256,   control = list() )"},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/fitflow_FW.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit Flow Using Freidlin‚ÄìWentzell Quasi-Potential ‚Äî fitflow_FW","text":"observed Empirical distribution Q. states Optional category names. flowtype Flow type. flowspec Structural parameters flow. inittheta Optional initial theta. drift Drift function b(x). x0 Starting point. x1 Target point. T Number time steps. dt Time step. eps Noise strength (small parameter). nmc Monte Carlo samples. control Control list optim().","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/fitflow_FW.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit Flow Using Freidlin‚ÄìWentzell Quasi-Potential ‚Äî fitflow_FW","text":"Output fitflowvariational().","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/fitflow_FW.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fit Flow Using Freidlin‚ÄìWentzell Quasi-Potential ‚Äî fitflow_FW","text":"useful rare-event inference small-noise diffusions, quasi-potential acts effective energy landscape.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/fitflow_girsanov.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit Flow with Girsanov-Tilted Likelihood ‚Äî fitflow_girsanov","title":"Fit Flow with Girsanov-Tilted Likelihood ‚Äî fitflow_girsanov","text":"Applies Girsanov change measure tilt likelihood fits flow-based variational posterior using fitflowvariational().","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/fitflow_girsanov.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit Flow with Girsanov-Tilted Likelihood ‚Äî fitflow_girsanov","text":"","code":"fitflow_girsanov(   observed,   states = NULL,   flowtype = \"maf\",   flowspec = list(),   inittheta = NULL,   base_pxgivenz,   theta_path,   Winc,   dt,   nmc = 256,   control = list() )"},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/fitflow_girsanov.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit Flow with Girsanov-Tilted Likelihood ‚Äî fitflow_girsanov","text":"observed Empirical distribution Q (probability vector). states Optional category names. flowtype Flow type (\"maf\", \"splinepwlin\", \"planar\", \"radial\"). flowspec Structural parameters flow. inittheta Optional initial theta trainable flows. base_pxgivenz Likelihood p(x|z) tilting. theta_path Drift-tilting function vector Girsanov. Winc Brownian increments. dt Time step. nmc Monte Carlo samples. control Control list optim().","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/fitflow_girsanov.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit Flow with Girsanov-Tilted Likelihood ‚Äî fitflow_girsanov","text":"Output fitflowvariational().","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/fitflow_girsanov.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fit Flow with Girsanov-Tilted Likelihood ‚Äî fitflow_girsanov","text":"useful target distribution arises drift-tilted diffusion process, Radon‚ÄìNikodym derivative given Girsanov theorem.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/Freidlin_Wentzell_action.html","id":null,"dir":"Reference","previous_headings":"","what":"Freidlin‚ÄìWentzell Action Functional ‚Äî Freidlin_Wentzell_action","title":"Freidlin‚ÄìWentzell Action Functional ‚Äî Freidlin_Wentzell_action","text":"Computes discrete Freidlin‚ÄìWentzell action path \\(\\phi(t)\\) represented matrix size T √ó d. continuous action :","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/Freidlin_Wentzell_action.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Freidlin‚ÄìWentzell Action Functional ‚Äî Freidlin_Wentzell_action","text":"","code":"Freidlin_Wentzell_action(phi, drift, dt)"},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/Freidlin_Wentzell_action.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Freidlin‚ÄìWentzell Action Functional ‚Äî Freidlin_Wentzell_action","text":"phi Matrix path values (T √ó d). drift Drift function \\(b(x)\\) returning numeric vector. dt Time step.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/Freidlin_Wentzell_action.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Freidlin‚ÄìWentzell Action Functional ‚Äî Freidlin_Wentzell_action","text":"Numeric action value.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/Freidlin_Wentzell_action.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Freidlin‚ÄìWentzell Action Functional ‚Äî Freidlin_Wentzell_action","text":"$$   [\\phi] = \\frac{1}{2} \\int_0^T \\| \\dot{\\phi}(t) - b(\\phi(t)) \\|^2 dt, $$ discrete approximation : $$   \\approx \\frac{1}{2} \\sum_{t=1}^{T-1}     \\| (\\phi_{t+1} - \\phi_t)/dt - b(\\phi_t) \\|^2 \\, dt. $$","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/FW_minimum_action_path.html","id":null,"dir":"Reference","previous_headings":"","what":"Minimum Action Path (MAP) ‚Äî FW_minimum_action_path","title":"Minimum Action Path (MAP) ‚Äî FW_minimum_action_path","text":"Computes simple Freidlin‚ÄìWentzell minimum action path two states using gradient descent discretized action functional.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/FW_minimum_action_path.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Minimum Action Path (MAP) ‚Äî FW_minimum_action_path","text":"","code":"FW_minimum_action_path(   x0,   x1,   drift,   T = 200,   dt = 0.01,   niter = 200,   stepsize = 0.1 )"},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/FW_minimum_action_path.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Minimum Action Path (MAP) ‚Äî FW_minimum_action_path","text":"x0 Starting point (numeric vector). x1 Target point (numeric vector). drift Drift function b(x). T Number time steps. dt Time step. niter Number gradient descent iterations. stepsize Gradient descent step size.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/FW_minimum_action_path.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Minimum Action Path (MAP) ‚Äî FW_minimum_action_path","text":"list : path: matrix size T √ó d action: FW action optimized path","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/FW_minimum_action_path.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Minimum Action Path (MAP) ‚Äî FW_minimum_action_path","text":"lightweight illustrative solver suitable low-dimensional systems. advanced solvers (string method, MAM, etc.) can integrated.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/FW_quasipotential.html","id":null,"dir":"Reference","previous_headings":"","what":"Freidlin‚ÄìWentzell Quasi-Potential via Path Minimization ‚Äî FW_quasipotential","title":"Freidlin‚ÄìWentzell Quasi-Potential via Path Minimization ‚Äî FW_quasipotential","text":"Computes approximate Freidlin‚ÄìWentzell quasi-potential two points \\(x_0\\) \\(x_1\\) minimizing FW action functional discretized paths.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/FW_quasipotential.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Freidlin‚ÄìWentzell Quasi-Potential via Path Minimization ‚Äî FW_quasipotential","text":"","code":"FW_quasipotential(   x0,   x1,   drift,   T = 200,   dt = 0.01,   niter = 200,   stepsize = 0.1 )"},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/FW_quasipotential.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Freidlin‚ÄìWentzell Quasi-Potential via Path Minimization ‚Äî FW_quasipotential","text":"x0 Starting point (numeric vector). x1 Target point (numeric vector). drift Drift function b(x). T Number time steps. dt Time step. niter Number gradient descent iterations. stepsize Gradient descent step size.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/FW_quasipotential.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Freidlin‚ÄìWentzell Quasi-Potential via Path Minimization ‚Äî FW_quasipotential","text":"list : path: matrix size T √ó d action: FW action optimized path","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/FW_quasipotential.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Freidlin‚ÄìWentzell Quasi-Potential via Path Minimization ‚Äî FW_quasipotential","text":"algorithm: Initializes straight-line path x0 x1. Performs simple gradient descent FW action. naive effective illustrative method low-dimensional systems. advanced solvers (string method, MAM, etc.) can plugged .","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/girsanov_logratio.html","id":null,"dir":"Reference","previous_headings":"","what":"Girsanov Log-Ratio for Drift-Tilted Diffusions ‚Äî girsanov_logratio","title":"Girsanov Log-Ratio for Drift-Tilted Diffusions ‚Äî girsanov_logratio","text":"Computes Radon‚ÄìNikodym derivative (log form) associated Girsanov change measure SDE:","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/girsanov_logratio.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Girsanov Log-Ratio for Drift-Tilted Diffusions ‚Äî girsanov_logratio","text":"","code":"girsanov_logratio(theta_path, Winc, dt)"},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/girsanov_logratio.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Girsanov Log-Ratio for Drift-Tilted Diffusions ‚Äî girsanov_logratio","text":"theta_path Numeric vector drift tilts \\(\\theta_t\\). Winc Numeric vector Brownian increments \\(\\Delta W_t\\). dt Time step size.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/girsanov_logratio.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Girsanov Log-Ratio for Drift-Tilted Diffusions ‚Äî girsanov_logratio","text":"numeric log-likelihood ratio.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/girsanov_logratio.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Girsanov Log-Ratio for Drift-Tilted Diffusions ‚Äî girsanov_logratio","text":"\\(dX_t = b(X_t)\\, dt + dW_t\\) tilted alternative drift: \\(dX_t = (b(X_t) + \\theta_t)\\, dt + dW_t\\). log-likelihood ratio : \\(\\log \\frac{dQ}{dP}     = \\sum_t \\left( \\theta_t W_{t} - \\frac{1}{2}\\theta_t^2\\, dt \\right)\\). function returns log-ratio given path drift tilts theta_path, Brownian increments Winc, time step dt.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/KLdiv.html","id":null,"dir":"Reference","previous_headings":"","what":"Kullback‚ÄìLeibler Divergence ‚Äî KLdiv","title":"Kullback‚ÄìLeibler Divergence ‚Äî KLdiv","text":"Computes KL divergence D(Q || P) two discrete probability distributions Q P.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/KLdiv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Kullback‚ÄìLeibler Divergence ‚Äî KLdiv","text":"","code":"KLdiv(Q, P)"},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/KLdiv.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Kullback‚ÄìLeibler Divergence ‚Äî KLdiv","text":"Q Observed distribution (probability vector). P Baseline reference distribution (probability vector).","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/KLdiv.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Kullback‚ÄìLeibler Divergence ‚Äî KLdiv","text":"numeric KL divergence value.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/logit.html","id":null,"dir":"Reference","previous_headings":"","what":"Logit Transform ‚Äî logit","title":"Logit Transform ‚Äî logit","text":"Computes log(u / (1 - u)).","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/logit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Logit Transform ‚Äî logit","text":"","code":"logit(u)"},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/logit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Logit Transform ‚Äî logit","text":"u Numeric input (0,1).","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/logit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Logit Transform ‚Äî logit","text":"Numeric logit value.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/mafflowmodel.html","id":null,"dir":"Reference","previous_headings":"","what":"Masked Autoregressive Flow (MAF) ‚Äî mafflowmodel","title":"Masked Autoregressive Flow (MAF) ‚Äî mafflowmodel","text":"readable structured implementation Masked Autoregressive Flow. version supports: arbitrary dimension d K sequential flow steps single parameter vector theta containing weights","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/mafflowmodel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Masked Autoregressive Flow (MAF) ‚Äî mafflowmodel","text":"","code":"mafflowmodel(d = 3, K = 2, theta = NULL)"},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/mafflowmodel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Masked Autoregressive Flow (MAF) ‚Äî mafflowmodel","text":"d Dimension latent space. K Number flow steps. theta Optional parameter vector. NULL, random initialization.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/mafflowmodel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Masked Autoregressive Flow (MAF) ‚Äî mafflowmodel","text":"flow model object methods: sampleq(n) logq(z0) applyflow(z0)","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/makebiolik.html","id":null,"dir":"Reference","previous_headings":"","what":"Biological Two-Separator Likelihood ‚Äî makebiolik","title":"Biological Two-Separator Likelihood ‚Äî makebiolik","text":"structure makeneurolik(), different default separation parameter. can used model simple biological switching systems coarse-grained gene expression states.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/makebiolik.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Biological Two-Separator Likelihood ‚Äî makebiolik","text":"","code":"makebiolik(a = 0.2)"},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/makebiolik.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Biological Two-Separator Likelihood ‚Äî makebiolik","text":"Separation parameter controlling spacing two logits.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/makebiolik.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Biological Two-Separator Likelihood ‚Äî makebiolik","text":"function mapping latent vector z probability vector.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/makeflow.html","id":null,"dir":"Reference","previous_headings":"","what":"Flow Factory ‚Äî makeflow","title":"Flow Factory ‚Äî makeflow","text":"unified constructor flow models rareflow package. function dispatches appropriate flow implementation based flowtype argument.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/makeflow.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Flow Factory ‚Äî makeflow","text":"","code":"makeflow(flowtype, params = list())"},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/makeflow.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Flow Factory ‚Äî makeflow","text":"flowtype Character string specifying flow type. params named list parameters required chosen flow.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/makeflow.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Flow Factory ‚Äî makeflow","text":"flow model object methods: sampleq(n) logq(z0) applyflow(z0)","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/makeflow.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Flow Factory ‚Äî makeflow","text":"Supported flow types: \"planar\"       -> planarflowmodel() \"radial\"       -> radialflowmodel() \"maf\"          -> mafflowmodel() \"splinepwlin\"  -> splinepwlinflowmodel()","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/makeflow.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Flow Factory ‚Äî makeflow","text":"","code":"# Create a planar flow f <- makeflow(\"planar\", list(u = 0.1, w = 0.2, b = 0)) s <- f$sampleq(10)  # Create a 2D spline flow f2 <- makeflow(\"splinepwlin\", list(d = 2, K = 8))"},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/makeneurolik.html","id":null,"dir":"Reference","previous_headings":"","what":"Neural Two-Separator Likelihood ‚Äî makeneurolik","title":"Neural Two-Separator Likelihood ‚Äî makeneurolik","text":"Constructs simple 3-category likelihood model based latent vector z. likelihood defined two logistic separators:","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/makeneurolik.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Neural Two-Separator Likelihood ‚Äî makeneurolik","text":"","code":"makeneurolik(a = 0.3)"},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/makeneurolik.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Neural Two-Separator Likelihood ‚Äî makeneurolik","text":"Separation parameter controlling spacing two logits.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/makeneurolik.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Neural Two-Separator Likelihood ‚Äî makeneurolik","text":"function mapping latent vector z probability vector.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/makeneurolik.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Neural Two-Separator Likelihood ‚Äî makeneurolik","text":"p1 = sigmoid(mean(z) - ) p2 = sigmoid(mean(z) + ) producing 3-class probability vector: (1 - p1, p1 - p2, p2) likelihood useful toy neural classification models simple latent--categorical mappings.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/or_or.html","id":null,"dir":"Reference","previous_headings":"","what":"Default Operator %||% ‚Äî or_or","title":"Default Operator %||% ‚Äî or_or","text":"Returns b NULL, otherwise returns .","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/or_or.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Default Operator %||% ‚Äî or_or","text":"","code":"a %||% b"},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/or_or.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Default Operator %||% ‚Äî or_or","text":"Primary value. b Default value.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/or_or.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Default Operator %||% ‚Äî or_or","text":"Either b.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/planarflowmodel.html","id":null,"dir":"Reference","previous_headings":"","what":"Planar Normalizing Flow (1D) ‚Äî planarflowmodel","title":"Planar Normalizing Flow (1D) ‚Äî planarflowmodel","text":"simple readable implementation 1-dimensional planar flow: z_K = z_0 + u * h(wz_0 + b)","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/planarflowmodel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Planar Normalizing Flow (1D) ‚Äî planarflowmodel","text":"","code":"planarflowmodel(u, w, b)"},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/planarflowmodel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Planar Normalizing Flow (1D) ‚Äî planarflowmodel","text":"u Scalar parameter controlling magnitude deformation. w Scalar parameter controlling slope activation. b Scalar bias term.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/planarflowmodel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Planar Normalizing Flow (1D) ‚Äî planarflowmodel","text":"flow model object methods: sampleq(n) logq(z0) applyflow(z0)","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/planarflowmodel.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Planar Normalizing Flow (1D) ‚Äî planarflowmodel","text":": h smooth activation (tanh) log-determinant computed analytically flow mainly useful pedagogical purposes lightweight building block variational inference.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/radialflowmodel.html","id":null,"dir":"Reference","previous_headings":"","what":"Radial Normalizing Flow (1D) ‚Äî radialflowmodel","title":"Radial Normalizing Flow (1D) ‚Äî radialflowmodel","text":"readable implementation 1-dimensional radial flow:","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/radialflowmodel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Radial Normalizing Flow (1D) ‚Äî radialflowmodel","text":"","code":"radialflowmodel(z_ref, alpha, beta)"},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/radialflowmodel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Radial Normalizing Flow (1D) ‚Äî radialflowmodel","text":"z_ref Reference point radial transformation. alpha Positive scalar controlling denominator. beta Scalar controlling magnitude deformation.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/radialflowmodel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Radial Normalizing Flow (1D) ‚Äî radialflowmodel","text":"flow model object methods: sampleq(n) logq(z0) applyflow(z0)","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/radialflowmodel.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Radial Normalizing Flow (1D) ‚Äî radialflowmodel","text":"z_K = z_0 + beta / (alpha + |z_0 - z_ref|) * (z_0 - z_ref) : z_ref reference point alpha > 0 ensures numerical stability beta controls strength radial deformation log-determinant computed analytically 1D case.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/rareflow-package.html","id":null,"dir":"Reference","previous_headings":"","what":"rareflow: Rare-event modeling with normalizing flows ‚Äî rareflow-package","title":"rareflow: Rare-event modeling with normalizing flows ‚Äî rareflow-package","text":"Tools variational inference, rare-event estimation, Girsanov tilting, Freidlin‚ÄìWentzell quasi-potentials.","code":""},{"path":[]},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/rareflow-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"rareflow: Rare-event modeling with normalizing flows ‚Äî rareflow-package","text":"Maintainer: Pietro Piu pietro.piu.si@gmail.com","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/sanovprob.html","id":null,"dir":"Reference","previous_headings":"","what":"Sanov Probability Bound ‚Äî sanovprob","title":"Sanov Probability Bound ‚Äî sanovprob","text":"Computes classical Sanov upper bound:","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/sanovprob.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sanov Probability Bound ‚Äî sanovprob","text":"","code":"sanovprob(Q, P, n)"},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/sanovprob.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sanov Probability Bound ‚Äî sanovprob","text":"Q Observed empirical distribution. P True distribution. n Sample size.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/sanovprob.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sanov Probability Bound ‚Äî sanovprob","text":"numeric upper bound.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/sanovprob.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Sanov Probability Bound ‚Äî sanovprob","text":"$$P(Q_n \\approx Q) \\le \\exp\\{-n \\, KL(Q \\| P)\\}$$ Q empirical distribution P true distribution.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/sigmoid.html","id":null,"dir":"Reference","previous_headings":"","what":"Sigmoid Activation ‚Äî sigmoid","title":"Sigmoid Activation ‚Äî sigmoid","text":"Standard logistic sigmoid function. Standard logistic sigmoid function.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/sigmoid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sigmoid Activation ‚Äî sigmoid","text":"","code":"sigmoid(x)  sigmoid(x)"},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/sigmoid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sigmoid Activation ‚Äî sigmoid","text":"x Numeric input.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/sigmoid.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sigmoid Activation ‚Äî sigmoid","text":"Numeric value 0 1. Numeric output (0,1).","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/softmax.html","id":null,"dir":"Reference","previous_headings":"","what":"Softmax Function ‚Äî softmax","title":"Softmax Function ‚Äî softmax","text":"Computes numerically stable softmax.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/softmax.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Softmax Function ‚Äî softmax","text":"","code":"softmax(x)"},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/softmax.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Softmax Function ‚Äî softmax","text":"x Numeric vector.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/softmax.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Softmax Function ‚Äî softmax","text":"Probability vector summing 1.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/splinepwlinflowmodel.html","id":null,"dir":"Reference","previous_headings":"","what":"Piecewise-Linear Spline Flow (Monotone) ‚Äî splinepwlinflowmodel","title":"Piecewise-Linear Spline Flow (Monotone) ‚Äî splinepwlinflowmodel","text":"readable implementation monotone piecewise-linear spline flow. dimension transformed independently using:","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/splinepwlinflowmodel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Piecewise-Linear Spline Flow (Monotone) ‚Äî splinepwlinflowmodel","text":"","code":"splinepwlinflowmodel(d = 2, K = 8, theta = NULL)"},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/splinepwlinflowmodel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Piecewise-Linear Spline Flow (Monotone) ‚Äî splinepwlinflowmodel","text":"d Dimension latent space. K Number spline bins. theta Optional parameter vector. NULL, random initialization.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/splinepwlinflowmodel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Piecewise-Linear Spline Flow (Monotone) ‚Äî splinepwlinflowmodel","text":"flow model object methods: sampleq(n) logq(z0) applyflow(z0)","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/reference/splinepwlinflowmodel.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Piecewise-Linear Spline Flow (Monotone) ‚Äî splinepwlinflowmodel","text":"K bins learned widths (w) heights (h) softmax ensures positivity normalization transformation applied sigmoid space stability flow invertible differentiable almost everywhere.","code":""},{"path":"https://pietropiu-labstats.github.io/rareflow/news/index.html","id":"rareflow-010","dir":"Changelog","previous_headings":"","what":"rareflow 0.1.0","title":"rareflow 0.1.0","text":"First public release rareflow, toolkit analyzing rare events stochastic dynamical systems. Implements Freidlin‚ÄìWentzell action functional deterministic stochastic paths. Provides FW_quasipotential() computing minimum action paths quasipotentials. Includes comprehensive vignette introducing theory large deviations (Sanov, Girsanov, Freidlin‚ÄìWentzell) practical examples. Offers clean, reproducible implementations suitable research, teaching, scientific communication.","code":""}]
